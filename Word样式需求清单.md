# Word 样式需求清单

本文档详细罗列日常办公中涉及的所有 Word 样式属性，用于指导文档编辑器的格式支持开发。

## 一、文本格式（字符级别）

### 1.1 字体相关

#### 1.1.1 字体族
- **西文字体**：Arial, Times New Roman, Calibri, Verdana, Tahoma, Courier New 等
- **中文字体**：宋体, 黑体, 微软雅黑, 仿宋, 楷体, 华文仿宋, 华文楷体 等
- **字体指定方式**：
  - `<w:rFonts w:ascii="Arial" w:hAnsi="Arial" w:eastAsia="宋体"/>`
  - 主题字体（Theme Fonts）：`w:hint="eastAsia"` 等

#### 1.1.2 字号
- **单位**：磅（pt）、号（中文传统单位）
- **常见字号**：8pt, 9pt, 10pt, 10.5pt, 11pt, 12pt, 14pt, 16pt, 18pt, 20pt, 22pt, 24pt, 26pt, 28pt, 36pt, 48pt, 72pt
- **DOCX 存储**：半磅单位（如 40 = 20pt）
- **提取方式**：`<w:sz w:val="40"/>` → 20pt

#### 1.1.3 字体颜色
- **颜色格式**：
  - 十六进制：`#FF0000`, `#000000`, `#FFFFFF`
  - RGB：`rgb(255, 0, 0)`
  - 主题颜色：`accent1`, `accent2`, `accent3`, `accent4`, `accent5`, `accent6`, `dark1`, `dark2`, `light1`, `light2`
  - 自动颜色：`auto`（通常为黑色）
- **DOCX 存储**：`<w:color w:val="FF0000"/>`（BGR 格式，需转换为 RGB）
- **应用场景**：标题强调、重点标注、错误提示、批注标记

#### 1.1.4 字体背景色（高亮）
- **颜色值**：黄色、绿色、蓝色、红色、粉色、青色等
- **DOCX 存储**：`<w:highlight w:val="yellow"/>`
- **HTML 转换**：`background-color: yellow`
- **应用场景**：重点标记、待办事项、错误标注

### 1.2 字符装饰

#### 1.2.1 粗体（Bold）
- **DOCX 存储**：`<w:b/>` 或 `<w:bCs/>`
- **HTML 转换**：`<strong>` 或 `font-weight: bold`
- **应用场景**：标题、重点强调

#### 1.2.2 斜体（Italic）
- **DOCX 存储**：`<w:i/>` 或 `<w:iCs/>`
- **HTML 转换**：`<em>` 或 `font-style: italic`
- **应用场景**：引用、强调、术语

#### 1.2.3 下划线（Underline）
- **下划线样式**：
  - 单线：`single`
  - 双线：`double`
  - 粗线：`thick`
  - 点线：`dotted`
  - 虚线：`dash`
  - 波浪线：`wave`
  - 无：`none`
- **下划线颜色**：`<w:u w:val="single" w:color="FF0000"/>`
- **DOCX 存储**：`<w:u w:val="single"/>`
- **HTML 转换**：`text-decoration: underline`
- **应用场景**：链接、重点标注、错误标记

#### 1.2.4 删除线（Strikethrough）
- **单删除线**：`<w:strike/>`
- **双删除线**：`<w:dstrike/>`
- **HTML 转换**：`text-decoration: line-through`
- **应用场景**：修订模式、错误修正、价格标注

#### 1.2.5 上标（Superscript）
- **DOCX 存储**：`<w:vertAlign w:val="superscript"/>`
- **HTML 转换**：`<sup>` 或 `vertical-align: super; font-size: smaller`
- **应用场景**：数学公式（x²）、化学式（H₂O）、脚注标记（¹）

#### 1.2.6 下标（Subscript）
- **DOCX 存储**：`<w:vertAlign w:val="subscript"/>`
- **HTML 转换**：`<sub>` 或 `vertical-align: sub; font-size: smaller`
- **应用场景**：化学式（H₂O）、数学公式、脚注标记

#### 1.2.7 小型大写字母（Small Caps）
- **DOCX 存储**：`<w:smallCaps/>`
- **HTML 转换**：`font-variant: small-caps`
- **应用场景**：标题、特殊排版

#### 1.2.8 全部大写（All Caps）
- **DOCX 存储**：`<w:caps/>`
- **HTML 转换**：`text-transform: uppercase`
- **应用场景**：标题、强调

#### 1.2.9 隐藏文字（Hidden Text）
- **DOCX 存储**：`<w:vanish/>`
- **应用场景**：注释、临时内容

### 1.3 字符间距和位置

#### 1.3.1 字符间距（Letter Spacing）
- **扩展**：`<w:spacing w:val="20"/>`（单位：twips，1/20 磅）
- **紧缩**：负值
- **HTML 转换**：`letter-spacing: 1pt`（20 twips = 1pt）
- **应用场景**：标题美化、特殊排版

#### 1.3.2 字符缩放（Character Scaling）
- **DOCX 存储**：`<w:w w:val="150"/>`（百分比，150% = 1.5 倍宽）
- **HTML 转换**：`transform: scaleX(1.5)`
- **应用场景**：标题加宽、特殊效果

#### 1.3.3 字符位置（Character Position）
- **提升**：`<w:position w:val="3"/>`（单位：半磅，3 = 1.5pt）
- **降低**：负值
- **HTML 转换**：`vertical-align: 1.5pt`
- **应用场景**：上标下标、特殊排版

### 1.4 字符效果

#### 1.4.1 阴影（Shadow）
- **DOCX 存储**：`<w:shadow/>`
- **HTML 转换**：`text-shadow: 1px 1px 2px rgba(0,0,0,0.3)`
- **应用场景**：标题美化、特殊效果

#### 1.4.2 轮廓（Outline）
- **DOCX 存储**：`<w:outline/>`
- **HTML 转换**：`-webkit-text-stroke: 1px black`
- **应用场景**：标题美化、特殊效果

#### 1.4.3 浮雕（Emboss）
- **DOCX 存储**：`<w:emboss/>`
- **应用场景**：特殊效果

#### 1.4.4 压印（Imprint）
- **DOCX 存储**：`<w:imprint/>`
- **应用场景**：特殊效果

## 二、段落格式

### 2.1 对齐方式

#### 2.1.1 水平对齐
- **左对齐**：`<w:jc w:val="left"/>` → `text-align: left`
- **居中**：`<w:jc w:val="center"/>` → `text-align: center`
- **右对齐**：`<w:jc w:val="right"/>` → `text-align: right`
- **两端对齐**：`<w:jc w:val="both"/>` → `text-align: justify`
- **分散对齐**：`<w:jc w:val="distribute"/>` → `text-align: justify; text-justify: distribute`
- **应用场景**：标题居中、正文左对齐、签名右对齐、正文两端对齐

#### 2.1.2 垂直对齐
- **顶端对齐**：`<w:vAlign w:val="top"/>`
- **居中**：`<w:vAlign w:val="center"/>`
- **底端对齐**：`<w:vAlign w:val="bottom"/>`
- **应用场景**：表格单元格、文本框

### 2.2 缩进

#### 2.2.1 左缩进
- **DOCX 存储**：`<w:ind w:left="720"/>`（单位：twips，720 = 0.5 英寸）
- **HTML 转换**：`margin-left: 0.5in` 或 `padding-left: 0.5in`
- **应用场景**：段落首行缩进、引用块、列表

#### 2.2.2 右缩进
- **DOCX 存储**：`<w:ind w:right="720"/>`
- **HTML 转换**：`margin-right: 0.5in`
- **应用场景**：特殊排版

#### 2.2.3 首行缩进
- **DOCX 存储**：`<w:ind w:firstLine="360"/>`（正值）或 `w:hanging="360"`（负值，悬挂缩进）
- **HTML 转换**：`text-indent: 0.25in`
- **应用场景**：中文段落首行缩进 2 字符

#### 2.2.4 悬挂缩进
- **DOCX 存储**：`<w:ind w:hanging="360"/>`
- **HTML 转换**：`text-indent: -0.25in; padding-left: 0.25in`
- **应用场景**：列表、引用

### 2.3 行距和段落间距

#### 2.3.1 行距（Line Spacing）
- **单倍行距**：`<w:spacing w:line="240" w:lineRule="auto"/>`（240 = 12pt）
- **1.5 倍行距**：`<w:spacing w:line="360" w:lineRule="auto"/>`（360 = 18pt）
- **2 倍行距**：`<w:spacing w:line="480" w:lineRule="auto"/>`（480 = 24pt）
- **固定值**：`<w:spacing w:line="240" w:lineRule="exact"/>`（精确值）
- **最小值**：`<w:spacing w:line="240" w:lineRule="atLeast"/>`
- **HTML 转换**：`line-height: 1.5` 或 `line-height: 18pt`
- **应用场景**：正文排版、标题间距

#### 2.3.2 段前间距
- **DOCX 存储**：`<w:spacing w:before="120"/>`（单位：twips，120 = 6pt）
- **HTML 转换**：`margin-top: 6pt`
- **应用场景**：段落间距、标题间距

#### 2.3.3 段后间距
- **DOCX 存储**：`<w:spacing w:after="120"/>`
- **HTML 转换**：`margin-bottom: 6pt`
- **应用场景**：段落间距、标题间距

### 2.4 分页和换行

#### 2.4.1 段前分页
- **DOCX 存储**：`<w:pageBreakBefore/>`
- **HTML 转换**：`page-break-before: always`
- **应用场景**：章节标题、新章节开始

#### 2.4.2 段中不分页
- **DOCX 存储**：`<w:keepNext/>`
- **HTML 转换**：`page-break-inside: avoid`
- **应用场景**：标题与正文不分离

#### 2.4.3 段内不分页
- **DOCX 存储**：`<w:keepLines/>`
- **HTML 转换**：`page-break-inside: avoid`
- **应用场景**：保持段落完整

#### 2.4.4 孤行控制
- **DOCX 存储**：`<w:widowControl/>`
- **应用场景**：防止段落首行或末行单独出现在页面

### 2.5 边框和底纹

#### 2.5.1 段落边框
- **边框类型**：上、下、左、右
- **边框样式**：单线、双线、虚线、点线、粗线、波浪线等
- **边框颜色**：任意颜色
- **边框宽度**：0.5pt, 1pt, 1.5pt, 2.25pt, 3pt, 4.5pt, 6pt
- **DOCX 存储**：`<w:pBdr><w:top w:val="single" w:sz="4" w:color="000000"/></w:pBdr>`
- **HTML 转换**：`border-top: 0.5pt solid #000000`
- **应用场景**：标题框、引用框、重点标注

#### 2.5.2 段落底纹
- **填充颜色**：`<w:shd w:fill="FFFF00" w:val="clear"/>`
- **HTML 转换**：`background-color: #FFFF00`
- **应用场景**：重点段落、引用块、标题背景

### 2.6 制表位（Tab Stops）

#### 2.6.1 制表位类型
- **左对齐**：`<w:tab w:val="left" w:pos="720"/>`
- **居中**：`<w:tab w:val="center" w:pos="1440"/>`
- **右对齐**：`<w:tab w:val="right" w:pos="2160"/>`
- **小数点对齐**：`<w:tab w:val="decimal" w:pos="2880"/>`
- **应用场景**：目录、表格、对齐数字

## 三、列表格式

### 3.1 项目符号列表

#### 3.1.1 符号类型
- **圆点**：`•`
- **方框**：`□`
- **箭头**：`→`
- **自定义符号**：任意字符或图片
- **DOCX 存储**：`<w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr>`
- **应用场景**：要点列表、待办事项

### 3.2 编号列表

#### 3.2.1 编号类型
- **阿拉伯数字**：1, 2, 3...
- **大写字母**：A, B, C...
- **小写字母**：a, b, c...
- **大写罗马数字**：I, II, III...
- **小写罗马数字**：i, ii, iii...
- **中文数字**：一、二、三...
- **应用场景**：步骤说明、章节编号、条款编号

#### 3.2.2 多级列表
- **级别**：1 级、2 级、3 级...（最多 9 级）
- **格式**：1.1, 1.1.1, 1.1.1.1...
- **应用场景**：文档大纲、章节结构

### 3.3 列表格式属性

#### 3.3.1 缩进
- **左缩进**：控制列表整体位置
- **悬挂缩进**：控制编号/符号与文本的间距
- **应用场景**：列表对齐

#### 3.3.2 间距
- **列表项间距**：段前、段后间距
- **应用场景**：列表排版

## 四、表格格式

### 4.1 表格结构

#### 4.1.1 行列
- **行数**：任意行数
- **列数**：任意列数
- **应用场景**：数据表格、对比表格

#### 4.1.2 单元格合并
- **横向合并**：`<w:gridSpan w:val="2"/>` → `colspan="2"`
- **纵向合并**：`<w:vMerge w:val="restart"/>` → `rowspan`
- **应用场景**：表头、跨列标题、跨行数据

### 4.2 表格样式

#### 4.2.1 表格对齐
- **左对齐**：`<w:jc w:val="left"/>`
- **居中**：`<w:jc w:val="center"/>`
- **右对齐**：`<w:jc w:val="right"/>`
- **HTML 转换**：`margin-left: auto; margin-right: auto;`（居中）
- **应用场景**：表格在页面中的位置

#### 4.2.2 表格宽度
- **固定宽度**：`<w:tblW w:w="5000" w:type="dxa"/>`（单位：twips）
- **百分比宽度**：`<w:tblW w:w="5000" w:type="pct"/>`（单位：1/50 百分比）
- **自动宽度**：`<w:tblW w:type="auto"/>`
- **HTML 转换**：`width: 100%` 或 `width: 250px`
- **应用场景**：表格大小控制

### 4.3 表格边框

#### 4.3.1 边框类型
- **上边框**：`<w:top w:val="single" w:sz="4" w:color="000000"/>`
- **下边框**：`<w:bottom w:val="single" w:sz="4" w:color="000000"/>`
- **左边框**：`<w:left w:val="single" w:sz="4" w:color="000000"/>`
- **右边框**：`<w:right w:val="single" w:sz="4" w:color="000000"/>`
- **内部水平边框**：`<w:insideH w:val="single" w:sz="4" w:color="000000"/>`
- **内部垂直边框**：`<w:insideV w:val="single" w:sz="4" w:color="000000"/>`

#### 4.3.2 边框样式
- **单线**：`single`
- **双线**：`double`
- **虚线**：`dashed`
- **点线**：`dotted`
- **粗线**：`thick`
- **无边框**：`nil`

#### 4.3.3 边框宽度
- **单位**：1/8 磅（如 4 = 0.5pt, 8 = 1pt, 12 = 1.5pt）
- **常见宽度**：0.5pt, 1pt, 1.5pt, 2.25pt, 3pt, 4.5pt, 6pt

#### 4.3.4 边框颜色
- **任意颜色**：十六进制、RGB、主题颜色
- **应用场景**：表格美化、重点标注

### 4.4 单元格格式

#### 4.4.1 单元格对齐
- **水平对齐**：左、中、右、两端对齐
- **垂直对齐**：`<w:vAlign w:val="top|center|bottom"/>`
- **HTML 转换**：`text-align: center; vertical-align: middle`
- **应用场景**：数据对齐、表头居中

#### 4.4.2 单元格背景色
- **填充颜色**：`<w:shd w:fill="FFFF00" w:val="clear"/>`
- **HTML 转换**：`background-color: #FFFF00`
- **应用场景**：表头、重点数据、交替行

#### 4.4.3 单元格宽度
- **固定宽度**：`<w:tcW w:w="1000" w:type="dxa"/>`
- **百分比宽度**：`<w:tcW w:w="2000" w:type="pct"/>`
- **自动宽度**：`<w:tcW w:type="auto"/>`
- **应用场景**：列宽控制

#### 4.4.4 单元格内边距
- **上内边距**：`<w:top w:w="108" w:type="dxa"/>`（108 = 6pt）
- **下内边距**：`<w:bottom w:w="108" w:type="dxa"/>`
- **左内边距**：`<w:left w:w="108" w:type="dxa"/>`
- **右内边距**：`<w:right w:w="108" w:type="dxa"/>`
- **HTML 转换**：`padding: 6pt`
- **应用场景**：单元格内容间距

### 4.5 表格行格式

#### 4.5.1 行高
- **固定高度**：`<w:trHeight w:val="240" w:hRule="exact"/>`（240 = 12pt）
- **最小值**：`<w:trHeight w:val="240" w:hRule="atLeast"/>`
- **自动高度**：`<w:trHeight w:hRule="auto"/>`
- **应用场景**：行高控制

#### 4.5.2 表头行
- **标记**：`<w:tblHeader/>`
- **应用场景**：表格第一行重复、打印表头

## 五、图片格式

### 5.1 图片大小

#### 5.1.1 宽度
- **单位**：EMU（English Metric Units，1 inch = 914400 EMU）
- **DOCX 存储**：`<wp:extent cx="2857500"/>`（约 3 英寸 = 288px @ 96 DPI）
- **HTML 转换**：`width: 300px` 或 `width: 50%`
- **应用场景**：图片大小控制

#### 5.1.2 高度
- **单位**：EMU
- **DOCX 存储**：`<wp:extent cy="2143125"/>`
- **HTML 转换**：`height: 225px` 或 `height: auto`（保持比例）
- **应用场景**：图片大小控制

#### 5.1.3 锁定纵横比
- **DOCX 存储**：`<a:xfrm><a:ext cx="..." cy="..."/></a:xfrm>`
- **应用场景**：防止图片变形

### 5.2 图片位置和对齐

#### 5.2.1 水平对齐
- **左对齐**：`<wp:positionH relativeFrom="page" posOffset="0"/>`
- **居中**：`<wp:positionH relativeFrom="page" posOffset="..."/>`
- **右对齐**：`<wp:positionH relativeFrom="page" posOffset="..."/>`
- **HTML 转换**：`float: left;` 或 `display: block; margin: 0 auto;`
- **应用场景**：图片在页面中的位置

#### 5.2.2 垂直对齐
- **顶端对齐**：`<wp:positionV relativeFrom="page" posOffset="0"/>`
- **居中**：`<wp:positionV relativeFrom="page" posOffset="..."/>`
- **底端对齐**：`<wp:positionV relativeFrom="page" posOffset="..."/>`
- **应用场景**：图片在页面中的位置

#### 5.2.3 文字环绕
- **四周型**：`<wp:wrapTopAndBottom/>`
- **紧密型**：`<wp:wrapSquare wrapText="bothSides"/>`
- **上下型**：`<wp:wrapTopAndBottom/>`
- **穿越型**：`<wp:wrapTight wrapText="bothSides"/>`
- **衬于文字下方**：`<wp:wrapNone/>`
- **浮于文字上方**：`<wp:wrapNone/>`
- **HTML 转换**：`float: left;` 或 `position: absolute;`
- **应用场景**：图文混排

### 5.3 图片效果

#### 5.3.1 边框
- **边框样式**：单线、双线、虚线等
- **边框颜色**：任意颜色
- **边框宽度**：0.5pt, 1pt, 1.5pt 等
- **HTML 转换**：`border: 1px solid #000000`
- **应用场景**：图片美化

#### 5.3.2 阴影
- **阴影类型**：外部阴影、内部阴影
- **阴影颜色**：任意颜色
- **阴影偏移**：X、Y 偏移量
- **阴影模糊**：模糊半径
- **HTML 转换**：`box-shadow: 2px 2px 4px rgba(0,0,0,0.3)`
- **应用场景**：图片美化

#### 5.3.3 图片标题
- **标题位置**：图片上方、下方
- **标题样式**：字体、字号、颜色、对齐
- **应用场景**：图片说明

### 5.4 图片格式支持

#### 5.4.1 常见格式
- **PNG**：支持透明背景
- **JPEG**：压缩格式，适合照片
- **GIF**：支持动画
- **WebP**：现代格式，高压缩比
- **BMP**：位图格式
- **SVG**：矢量图格式

#### 5.4.2 特殊格式（需转换）
- **TIFF**：需转换为 PNG
- **WMF/EMF**：Windows 图元文件，需转换为 PNG

## 六、超链接格式

### 6.1 链接文本

#### 6.1.1 链接样式
- **默认样式**：蓝色、下划线
- **访问后样式**：紫色
- **自定义样式**：任意颜色、下划线样式
- **应用场景**：网页链接、文档内链接、邮件链接

### 6.2 链接类型

#### 6.2.1 外部链接
- **URL**：`http://`, `https://`, `ftp://`
- **应用场景**：网页链接、文件下载

#### 6.2.2 内部链接
- **书签链接**：链接到文档内书签
- **标题链接**：链接到文档内标题
- **应用场景**：目录、交叉引用

#### 6.2.3 邮件链接
- **格式**：`mailto:example@email.com`
- **应用场景**：联系方式

## 七、页面格式

### 7.1 页面设置

#### 7.1.1 页面大小
- **A4**：210mm × 297mm
- **A3**：297mm × 420mm
- **Letter**：8.5" × 11"
- **Legal**：8.5" × 14"
- **自定义**：任意尺寸

#### 7.1.2 页面方向
- **纵向**：Portrait
- **横向**：Landscape

#### 7.1.3 页边距
- **上边距**：默认 2.54cm（1 英寸）
- **下边距**：默认 2.54cm
- **左边距**：默认 3.18cm（1.25 英寸）
- **右边距**：默认 3.18cm
- **装订线**：额外边距，用于装订

### 7.2 页眉页脚

#### 7.2.1 页眉
- **内容**：标题、页码、日期、公司名称等
- **位置**：页面顶部
- **样式**：字体、字号、颜色、对齐

#### 7.2.2 页脚
- **内容**：页码、日期、版权信息等
- **位置**：页面底部
- **样式**：字体、字号、颜色、对齐

#### 7.2.3 页码
- **格式**：1, 2, 3... 或 I, II, III... 或 一、二、三...
- **位置**：页眉或页脚
- **起始页码**：可自定义

### 7.3 分栏

#### 7.3.1 栏数
- **单栏**：默认
- **双栏**：两栏排版
- **三栏**：三栏排版
- **多栏**：最多 13 栏

#### 7.3.2 栏间距
- **默认**：0.5cm
- **自定义**：任意间距

#### 7.3.3 分隔线
- **有无分隔线**：可设置
- **分隔线样式**：单线、双线等

## 八、样式和主题

### 8.1 内置样式

#### 8.1.1 标题样式
- **标题 1**：`Heading 1`，大号、粗体
- **标题 2**：`Heading 2`，中号、粗体
- **标题 3**：`Heading 3`，小号、粗体
- **标题 4-9**：`Heading 4-9`，递减字号

#### 8.1.2 正文样式
- **正文**：`Normal`，默认格式
- **正文（无缩进）**：`No Spacing`
- **正文（首行缩进）**：`Body Text`

#### 8.1.3 其他样式
- **引用**：`Quote`，斜体、缩进
- **强调**：`Emphasis`，斜体
- **强烈强调**：`Strong`，粗体
- **标题**：`Title`，大号、居中
- **副标题**：`Subtitle`，中号、居中

### 8.2 自定义样式

#### 8.2.1 字符样式
- **基于**：现有字符样式
- **格式**：字体、字号、颜色、粗体、斜体等
- **应用场景**：统一格式、快速应用

#### 8.2.2 段落样式
- **基于**：现有段落样式
- **格式**：对齐、缩进、行距、边框、底纹等
- **应用场景**：统一格式、快速应用

#### 8.2.3 表格样式
- **内置样式**：网格型、列表型、彩色型等
- **自定义样式**：边框、背景色、字体等
- **应用场景**：统一表格外观

### 8.3 主题

#### 8.3.1 主题颜色
- **主色**：文档主要颜色
- **强调色**：`accent1-6`
- **文字颜色**：`dark1-2`, `light1-2`
- **超链接颜色**：链接、已访问链接
- **应用场景**：统一配色方案

#### 8.3.2 主题字体
- **标题字体**：用于标题
- **正文字体**：用于正文
- **应用场景**：统一字体方案

## 九、高级格式

### 9.1 文本框

#### 9.1.1 文本框格式
- **位置**：绝对定位
- **大小**：宽度、高度
- **边框**：样式、颜色、宽度
- **填充**：背景色、透明度
- **应用场景**：特殊排版、标注

### 9.2 艺术字

#### 9.2.1 艺术字效果
- **样式**：阴影、轮廓、发光、3D 等
- **变形**：弯曲、扭曲等
- **应用场景**：标题美化

### 9.3 公式

#### 9.3.1 数学公式
- **格式**：LaTeX、MathML
- **显示**：内联公式、块级公式
- **应用场景**：数学文档、科学论文

### 9.4 批注和修订

#### 9.4.1 批注
- **批注者**：作者名称
- **批注时间**：创建时间
- **批注内容**：评论文本
- **应用场景**：文档审核、协作编辑

#### 9.4.2 修订
- **插入**：绿色、下划线
- **删除**：红色、删除线
- **格式更改**：蓝色、标记
- **应用场景**：文档修订、版本对比

### 9.5 目录和索引

#### 9.5.1 目录
- **自动生成**：基于标题样式
- **格式**：页码、点线、缩进
- **更新**：自动更新
- **应用场景**：长文档导航

#### 9.5.2 索引
- **索引项**：关键词、页码
- **格式**：排序、分组
- **应用场景**：术语索引、概念索引

### 9.6 脚注和尾注

#### 9.6.1 脚注
- **位置**：页面底部
- **标记**：数字、符号
- **格式**：字体、字号、分隔线
- **应用场景**：引用说明、补充信息

#### 9.6.2 尾注
- **位置**：文档末尾
- **标记**：数字、符号
- **格式**：字体、字号
- **应用场景**：参考文献、详细说明

## 十、特殊字符和符号

### 10.1 特殊字符

#### 10.1.1 标点符号
- **中文标点**：，。；：？！""''（）【】《》
- **英文标点**：, . ; : ? ! " ' ( ) [ ] { }
- **应用场景**：文本输入

#### 10.1.2 数学符号
- **运算符**：+ - × ÷ = ≠ ≤ ≥ ±
- **希腊字母**：α β γ δ ε θ λ π σ φ
- **应用场景**：数学公式、科学文档

#### 10.1.3 单位符号
- **长度**：m, cm, mm, km, in, ft
- **重量**：kg, g, mg, lb, oz
- **时间**：s, min, h, d, y
- **应用场景**：技术文档、科学文档

### 10.2 符号字体

#### 10.2.1 Wingdings
- **符号类型**：图形符号
- **应用场景**：装饰、标记

#### 10.2.2 Symbol
- **符号类型**：数学符号、希腊字母
- **应用场景**：数学公式

## 十一、格式优先级和继承

### 11.1 格式优先级

#### 11.1.1 优先级顺序
1. **直接格式**：手动应用的格式（最高优先级）
2. **字符样式**：应用的字符样式
3. **段落样式**：应用的段落样式
4. **默认格式**：文档默认格式（最低优先级）

### 11.2 格式继承

#### 11.2.1 运行级别继承
- **运行格式** → **段落格式** → **样式定义**
- **应用场景**：格式统一、减少重复设置

#### 11.2.2 段落级别继承
- **段落格式** → **样式定义** → **文档默认**
- **应用场景**：格式统一

## 十二、常用办公场景格式需求

### 12.1 公文格式

#### 12.1.1 标题
- **字体**：黑体或宋体
- **字号**：22pt 或 20pt
- **对齐**：居中
- **行距**：固定值 28pt

#### 12.1.2 正文
- **字体**：仿宋
- **字号**：16pt
- **行距**：固定值 28pt
- **首行缩进**：2 字符

#### 12.1.3 段落
- **段前间距**：0pt
- **段后间距**：0pt

### 12.2 报告格式

#### 12.2.1 封面
- **标题**：大号、粗体、居中
- **副标题**：中号、居中
- **作者信息**：右对齐
- **日期**：居中或右对齐

#### 12.2.2 目录
- **标题**：粗体、居中
- **条目**：左对齐、悬挂缩进
- **页码**：右对齐、点线连接

#### 12.2.3 正文
- **标题**：多级标题、自动编号
- **正文**：两端对齐、首行缩进
- **图表**：居中、标题、编号

### 12.3 简历格式

#### 12.3.1 标题
- **姓名**：大号、粗体、居中
- **联系方式**：小号、居中

#### 12.3.2 章节
- **章节标题**：中号、粗体、左对齐
- **内容**：小号、左对齐、项目符号

#### 12.3.3 表格
- **个人信息表格**：边框、对齐、背景色

### 12.4 合同格式

#### 12.4.1 标题
- **合同名称**：大号、粗体、居中

#### 12.4.2 正文
- **条款编号**：自动编号、粗体
- **条款内容**：左对齐、首行缩进
- **重要条款**：加粗、背景色

#### 12.4.3 签名
- **签名区域**：表格、右对齐
- **日期**：右对齐

### 12.5 表格文档

#### 12.5.1 数据表格
- **表头**：粗体、背景色、居中
- **数据行**：交替背景色、对齐
- **边框**：单线、统一颜色

#### 12.5.2 统计表格
- **汇总行**：粗体、背景色、特殊格式
- **数据格式**：数字格式、对齐

## 十三、格式兼容性说明

### 13.1 HTML 转换支持

#### 13.1.1 完全支持
- 字体、字号、颜色
- 粗体、斜体、下划线
- 段落对齐、缩进
- 表格结构、边框、背景色
- 图片大小、对齐

#### 13.1.2 部分支持
- 行距（需转换为固定值）
- 字符间距（需转换为固定值）
- 下划线颜色（需单独处理）
- 复杂边框样式（部分样式需简化）

#### 13.1.3 不支持（需特殊处理）
- 页眉页脚（需单独提取）
- 页码（需单独处理）
- 分栏（需转换为单栏）
- 文本框（需转换为普通段落）
- 艺术字（需转换为普通文本）
- 公式（需转换为图片或 MathML）
- 批注修订（需单独显示）

### 13.2 编辑器支持

#### 13.2.1 TipTap 原生支持
- 文本格式（字体、字号、颜色、粗体、斜体、下划线）
- 段落格式（对齐、缩进）
- 表格（结构、样式）
- 图片（大小、对齐）

#### 13.2.2 需扩展支持
- 字符间距（需自定义扩展）
- 行距（需自定义扩展）
- 上标下标（需自定义扩展）
- 背景色（需自定义扩展）
- 复杂边框（需自定义扩展）

## 十四、格式提取优先级

### 14.1 高优先级（必须支持）

1. **文本格式**
   - 字体、字号、颜色
   - 粗体、斜体、下划线
   - 背景色（高亮）

2. **段落格式**
   - 对齐（左、中、右、两端对齐）
   - 首行缩进
   - 行距

3. **表格格式**
   - 表格结构（行列、合并）
   - 边框、背景色
   - 对齐

4. **图片格式**
   - 大小、对齐
   - 路径

### 14.2 中优先级（建议支持）

1. **字符格式**
   - 字符间距
   - 上标下标
   - 删除线

2. **段落格式**
   - 段前段后间距
   - 边框、底纹
   - 制表位

3. **列表格式**
   - 项目符号
   - 编号列表
   - 多级列表

### 14.3 低优先级（可选支持）

1. **高级格式**
   - 文本框
   - 艺术字
   - 公式

2. **页面格式**
   - 页眉页脚
   - 页码
   - 分栏

3. **协作格式**
   - 批注
   - 修订

## 十五、总结

本文档全面列出了日常办公中涉及的所有 Word 样式属性，包括：

### 15.1 格式类别统计

- **文本格式**：字体、字号、颜色、背景色、字符装饰、字符间距、字符位置、字符效果等（共 30+ 项）
- **段落格式**：对齐、缩进、行距、段落间距、分页、边框、底纹、制表位等（共 20+ 项）
- **列表格式**：项目符号、编号列表、多级列表、列表缩进、列表间距等（共 10+ 项）
- **表格格式**：表格结构、表格样式、表格边框、单元格格式、表格行格式等（共 25+ 项）
- **图片格式**：图片大小、图片位置、图片对齐、文字环绕、图片效果、图片标题等（共 15+ 项）
- **超链接格式**：链接文本、链接样式、链接类型等（共 5+ 项）
- **页面格式**：页面设置、页眉页脚、页码、分栏等（共 10+ 项）
- **样式和主题**：内置样式、自定义样式、主题颜色、主题字体等（共 15+ 项）
- **高级格式**：文本框、艺术字、公式、批注修订、目录索引、脚注尾注等（共 20+ 项）
- **特殊字符和符号**：特殊字符、符号字体等（共 5+ 项）

**总计**：150+ 种格式属性

### 15.2 核心格式需求（日常办公必备）

#### 15.2.1 文本格式（必须支持）
1. **字体**：中文字体（宋体、黑体、微软雅黑、仿宋、楷体）、西文字体（Arial、Times New Roman、Calibri）
2. **字号**：8pt-72pt，常用 10pt、12pt、14pt、16pt、18pt、20pt、22pt、24pt
3. **字体颜色**：十六进制颜色、RGB 颜色、主题颜色
4. **字体背景色**：高亮颜色（黄色、绿色、蓝色、红色等）
5. **粗体**：`<w:b/>` → `font-weight: bold`
6. **斜体**：`<w:i/>` → `font-style: italic`
7. **下划线**：单线、双线、点线、虚线、波浪线，支持下划线颜色
8. **删除线**：单删除线、双删除线
9. **上标下标**：上标（数学公式、化学式）、下标（化学式、脚注）
10. **字符间距**：扩展、紧缩（单位：twips）

#### 15.2.2 段落格式（必须支持）
1. **对齐方式**：左对齐、居中、右对齐、两端对齐、分散对齐
2. **缩进**：左缩进、右缩进、首行缩进、悬挂缩进
3. **行距**：单倍、1.5 倍、2 倍、固定值、最小值
4. **段落间距**：段前间距、段后间距
5. **首行缩进**：中文段落常用 2 字符缩进

#### 15.2.3 表格格式（必须支持）
1. **表格结构**：行数、列数、单元格合并（横向、纵向）
2. **表格对齐**：左对齐、居中、右对齐
3. **表格宽度**：固定宽度、百分比宽度、自动宽度
4. **表格边框**：上、下、左、右、内部水平、内部垂直边框，支持样式、颜色、宽度
5. **单元格对齐**：水平对齐（左、中、右）、垂直对齐（上、中、下）
6. **单元格背景色**：填充颜色
7. **单元格宽度**：固定宽度、百分比宽度、自动宽度
8. **单元格内边距**：上、下、左、右内边距
9. **行高**：固定高度、最小值、自动高度
10. **表头行**：标记表头行，用于重复显示

#### 15.2.4 图片格式（必须支持）
1. **图片大小**：宽度、高度（单位：EMU，转换为 px）
2. **图片对齐**：水平对齐（左、中、右）、垂直对齐（上、中、下）
3. **文字环绕**：四周型、紧密型、上下型、穿越型、衬于文字下方、浮于文字上方
4. **图片边框**：样式、颜色、宽度
5. **图片阴影**：外部阴影、内部阴影、颜色、偏移、模糊
6. **图片标题**：标题位置、标题样式

#### 15.2.5 列表格式（建议支持）
1. **项目符号**：圆点、方框、箭头、自定义符号
2. **编号列表**：阿拉伯数字、大写字母、小写字母、大写罗马数字、小写罗马数字、中文数字
3. **多级列表**：1-9 级，格式如 1.1, 1.1.1
4. **列表缩进**：左缩进、悬挂缩进
5. **列表间距**：列表项间距

### 15.3 格式提取和应用策略

#### 15.3.1 提取策略
1. **层次化提取**：运行级别 → 段落级别 → 样式定义 → 文档默认
2. **格式继承**：运行格式优先，段落格式次之，样式定义最后
3. **格式合并**：相同格式的运行合并为一个 `<span>` 标签
4. **格式转换**：DOCX 格式 → HTML 内联样式 → TipTap 编辑器格式

#### 15.3.2 应用策略
1. **内联样式优先**：所有格式转换为内联样式，确保 TipTap 编辑器正确解析
2. **格式保留**：尽可能保留所有格式信息，不丢失任何格式属性
3. **格式兼容**：对于不支持的格式，转换为最接近的 HTML/CSS 格式
4. **格式优化**：合并相同格式，减少 HTML 标签嵌套

### 15.4 格式支持优先级

#### 15.4.1 P0 优先级（核心功能，必须实现）
- 字体、字号、颜色
- 粗体、斜体、下划线
- 段落对齐、首行缩进
- 行距（单倍、1.5 倍、2 倍、固定值）
- 表格结构、边框、背景色、对齐
- 图片大小、对齐、路径

#### 15.4.2 P1 优先级（重要功能，建议实现）
- 字体背景色（高亮）
- 字符间距
- 上标下标
- 删除线
- 段前段后间距
- 表格单元格合并、内边距
- 图片边框、阴影
- 列表格式（项目符号、编号）

#### 15.4.3 P2 优先级（增强功能，可选实现）
- 下划线颜色
- 字符缩放、字符位置
- 段落边框、底纹
- 制表位
- 多级列表
- 图片文字环绕
- 超链接格式
- 页面格式（页眉页脚、页码）

#### 15.4.4 P3 优先级（高级功能，后续实现）
- 文本框
- 艺术字
- 公式
- 批注修订
- 目录索引
- 脚注尾注
- 分栏
- 主题和样式

### 15.5 格式兼容性矩阵

| 格式类别 | DOCX 提取 | HTML 转换 | TipTap 支持 | 优先级 |
|---------|----------|-----------|------------|--------|
| 字体、字号、颜色 | ✅ | ✅ | ✅ | P0 |
| 粗体、斜体、下划线 | ✅ | ✅ | ✅ | P0 |
| 字体背景色 | ✅ | ✅ | ⚠️ 需扩展 | P1 |
| 字符间距 | ✅ | ✅ | ⚠️ 需扩展 | P1 |
| 上标下标 | ✅ | ✅ | ⚠️ 需扩展 | P1 |
| 段落对齐 | ✅ | ✅ | ✅ | P0 |
| 首行缩进 | ✅ | ✅ | ✅ | P0 |
| 行距 | ✅ | ✅ | ⚠️ 需扩展 | P0 |
| 段前段后间距 | ✅ | ✅ | ⚠️ 需扩展 | P1 |
| 表格结构 | ✅ | ✅ | ✅ | P0 |
| 表格边框 | ✅ | ✅ | ✅ | P0 |
| 表格背景色 | ✅ | ✅ | ✅ | P0 |
| 单元格合并 | ✅ | ✅ | ✅ | P0 |
| 图片大小 | ✅ | ✅ | ✅ | P0 |
| 图片对齐 | ✅ | ✅ | ✅ | P0 |
| 列表格式 | ✅ | ✅ | ✅ | P1 |
| 超链接 | ✅ | ✅ | ✅ | P2 |
| 页眉页脚 | ✅ | ⚠️ 需单独处理 | ❌ | P3 |
| 页码 | ✅ | ⚠️ 需单独处理 | ❌ | P3 |
| 分栏 | ✅ | ⚠️ 需转换 | ❌ | P3 |
| 文本框 | ✅ | ⚠️ 需转换 | ❌ | P3 |
| 艺术字 | ✅ | ⚠️ 需转换 | ❌ | P3 |
| 公式 | ✅ | ⚠️ 需转换 | ❌ | P3 |

**图例**：
- ✅ 完全支持
- ⚠️ 部分支持或需扩展
- ❌ 不支持

### 15.6 开发建议

#### 15.6.1 分阶段实现
1. **第一阶段**：实现 P0 优先级格式（核心功能）
2. **第二阶段**：实现 P1 优先级格式（重要功能）
3. **第三阶段**：实现 P2 优先级格式（增强功能）
4. **第四阶段**：实现 P3 优先级格式（高级功能）

#### 15.6.2 技术实现要点
1. **格式提取**：使用 `quick-xml` 解析 DOCX XML，提取所有格式属性
2. **格式转换**：建立 DOCX 格式到 HTML/CSS 的映射表
3. **格式应用**：使用 `scraper` 或 `html5ever` 操作 HTML DOM，应用格式
4. **编辑器集成**：使用 TipTap 扩展支持自定义格式

#### 15.6.3 测试策略
1. **单元测试**：测试每个格式属性的提取和转换
2. **集成测试**：测试完整文档的格式保留
3. **兼容性测试**：测试不同 Word 版本生成的 DOCX 文件
4. **性能测试**：测试大文档的格式提取和应用性能

### 15.7 参考资源

#### 15.7.1 DOCX 格式规范
- **ECMA-376**：Office Open XML 标准
- **ISO/IEC 29500**：Office Open XML 国际标准
- **Microsoft Office Open XML**：官方文档

#### 15.7.2 相关工具和库
- **Pandoc**：文档格式转换工具
- **quick-xml**：Rust XML 解析库
- **scraper**：Rust HTML 解析和操作库
- **TipTap**：富文本编辑器框架
- **html5ever**：Rust HTML 解析库

#### 15.7.3 格式转换参考
- **DOCX to HTML**：Pandoc 转换规则
- **HTML to DOCX**：Pandoc 转换规则
- **CSS 样式映射**：HTML/CSS 样式参考

---

**文档版本**：v1.0  
**最后更新**：2024-12  
**维护者**：开发团队  
**用途**：指导文档编辑器格式支持开发