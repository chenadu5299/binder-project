# 预览功能技术框架

## 文档信息

- **文档版本**：v1.0
- **创建日期**：2025年
- **文档性质**：技术架构文档
- **适用范围**：Binder DOCX、Excel 和演示文稿预览功能
- **对应需求文档**：`DOCX、Excel和演示文稿预览功能需求文档.md`

---

## 一、技术选型原则

### 1.1 选型原则

**核心原则：**
1. **稳定性优先**：选择成熟、稳定的技术方案
2. **性能优先**：满足性能需求（首次 < 15 秒，缓存后 < 3 秒）
3. **准确性优先**：格式还原准确率 ≥ 95%，数据准确性 100%
4. **统一性优先**：三种预览功能使用统一的技术方案
5. **可维护性优先**：代码简洁，维护成本低

**技术选型标准：**
- ✅ 成熟稳定：技术栈经过大量项目验证
- ✅ 性能优秀：满足性能需求
- ✅ 兼容性好：支持所有目标格式
- ✅ 开发效率高：代码可复用，开发快速
- ✅ 维护成本低：技术栈简单，易于维护

---

## 二、核心需求分析

### 2.1 功能需求

**核心功能：**
- DOCX 预览：支持 DOCX、DOC、ODT、RTF
- Excel 预览：支持 XLSX、XLS、CSV、ODS
- 演示文稿预览：支持 PPTX、PPT、PPSX、PPS、ODP

**交互功能：**
- 文本选中和复制（必须）
- 搜索功能（必须）
- 缩放功能（必须）
- 打印功能（必须）
- 引用功能（必须）
- 工作表/幻灯片导航（P1）

### 2.2 性能需求

**加载性能：**
- 首次加载：< 15 秒
- 缓存后加载：< 3 秒
- 大文件（> 10MB）：< 30 秒

**资源占用：**
- 内存占用：< 300MB（单个文件）
- CPU 占用：加载时 < 50%，预览时 < 10%

### 2.3 准确性需求

**预览准确性：**
- 格式还原准确率：≥ 95%
- 数据准确性：100%（数据不丢失）
- 布局还原准确率：≥ 90%（演示文稿）

---

## 三、技术架构设计

### 3.1 整体架构

```
┌─────────────────────────────────────────────────────────────┐
│                        前端层 (React)                         │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐        │
│  │ DOCX Preview │  │Excel Preview │  │Presentation │        │
│  │  Component   │  │  Component  │  │  Preview    │        │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘        │
│         │                  │                  │                │
│         └──────────────────┼──────────────────┘                │
│                            │                                    │
│                   ┌─────────▼─────────┐                        │
│                   │  Preview Service  │                        │
│                   │  (统一预览服务)    │                        │
│                   └─────────┬─────────┘                        │
└──────────────────────────────┼──────────────────────────────────┘
                               │
┌──────────────────────────────▼──────────────────────────────────┐
│                      Tauri 命令层 (Rust)                        │
│  ┌──────────────────────────────────────────────────────┐      │
│  │  preview_docx_as_pdf                                │      │
│  │  preview_excel_as_pdf                               │      │
│  │  preview_presentation_as_pdf                       │      │
│  └──────────────────┬─────────────────────────────────┘      │
│                     │                                            │
│         ┌───────────▼───────────┐                              │
│         │ LibreOffice Service   │                              │
│         │ (文档转换服务)         │                              │
│         └───────────┬───────────┘                              │
│                     │                                            │
│         ┌───────────▼───────────┐                              │
│         │   LibreOffice CLI     │                              │
│         │   (soffice 命令)      │                              │
│         └───────────────────────┘                              │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 技术栈选型

#### 3.2.1 文档转换层

**选型：LibreOffice CLI（soffice）**

**理由：**
- ✅ **格式支持全面**：支持 DOCX、DOC、ODT、RTF、XLSX、XLS、ODS、PPTX、PPT、PPSX、PPS、ODP 等格式
- ⚠️ **CSV 例外**：CSV 使用独立方案（直接解析为 HTML 表格），不使用 PDF 转换
- ✅ **转换质量高**：格式还原准确率 ≥ 95%，数据准确性 100%
- ✅ **成熟稳定**：LibreOffice 是成熟的开源办公套件，经过大量项目验证
- ✅ **跨平台支持**：支持 macOS、Windows、Linux
- ✅ **已实现验证**：DOCX 预览已使用此方案，效果良好

**技术实现：**
- 使用 `soffice --headless --convert-to pdf` 命令进行转换
- 支持批量转换和缓存机制
- 转换结果保存为 PDF 文件

**性能优化：**
- 缓存机制：转换结果缓存 1 小时
- 异步转换：不阻塞主线程
- 进度反馈：通过事件系统反馈转换进度

#### 3.2.2 预览渲染层

**选型：PDF + 浏览器原生 PDF 查看器（iframe + data URL）**

**理由：**
- ✅ **交互功能完整**：浏览器原生支持文本选择、复制、搜索、缩放、打印
- ✅ **性能优秀**：浏览器原生渲染，性能最优
- ✅ **代码简洁**：无需引入额外的 PDF 渲染库，代码简洁
- ✅ **维护成本低**：依赖浏览器原生功能，维护成本低
- ✅ **已实现验证**：DOCX 预览已使用此方案，效果良好

**技术实现：**
- 使用 `iframe` 标签加载 PDF
- 使用 `data URL` 方式嵌入 PDF（`data:application/pdf;base64,{base64}`）
- 依赖浏览器原生 PDF 查看器

**优势：**
- 文本选择：浏览器原生支持，无需额外实现
- 文本复制：浏览器原生支持，无需额外实现
- 搜索功能：浏览器原生支持（Cmd+F），无需额外实现
- 缩放功能：浏览器原生支持，无需额外实现
- 打印功能：浏览器原生支持（Cmd+P），无需额外实现

**限制：**
- 不支持自定义页面跳转输入框（浏览器原生不支持）
- 不支持自定义搜索范围选择（浏览器原生不支持）
- 不支持自定义缩放控制（浏览器原生不支持）

**解决方案：**
- MVP 1.0：使用浏览器原生功能，满足核心需求
- P1/P2：如需自定义功能，可考虑使用 PDF.js（但会失去原生优势）

#### 3.2.3 引用功能层

**选型：前端自定义实现（React + 事件监听）**

**理由：**
- ✅ **功能需求**：需要自定义引用格式生成和跳转
- ✅ **浏览器原生不支持**：PDF 查看器不支持自定义引用功能
- ✅ **实现简单**：前端监听文本选择事件，生成引用格式

**技术实现：**
- 监听 PDF iframe 内的文本选择事件
- 解析选中的文本和位置信息
- 生成引用格式（`@文件名!位置`）
- 提供引用按钮和复制功能

**技术方案：**
- 使用 `Selection API` 监听文本选择
- 使用 `Clipboard API` 复制引用格式
- 使用 `postMessage` 实现 iframe 内外通信（如需要）

#### 3.2.4 导航功能层

**选型：前端自定义实现（React 组件）**

**理由：**
- ✅ **功能需求**：需要工作表标签栏和幻灯片缩略图导航
- ✅ **PDF 预览限制**：PDF 是单页面格式，无法直接显示工作表/幻灯片结构
- ✅ **实现方案**：通过 PDF 页码映射工作表/幻灯片

**技术实现：**

**MVP 1.0 基础方案：**
- 通过 PDF 页码映射工作表/幻灯片
- 每个工作表对应 PDF 的连续页面
- 每张幻灯片对应 PDF 的一页
- 使用浏览器原生导航（上一页/下一页）

**P1 优化方案：**
- 添加工作表标签栏组件（底部）
- 添加幻灯片缩略图组件（侧边栏）
- 点击标签/缩略图跳转到对应 PDF 页面
- 显示当前工作表/幻灯片名称

**技术方案：**
- 使用 `iframe.contentWindow.postMessage` 控制 PDF 页面跳转
- 使用 React 组件实现标签栏和缩略图
- 维护工作表/幻灯片与 PDF 页码的映射关系

---

## 四、技术实现细节

### 4.1 文档转换流程

```
用户打开文件
    │
    ▼
前端：识别文件类型（DOCX/Excel/演示文稿）
    │
    ▼
前端：调用 Tauri 命令（preview_xxx_as_pdf）
    │
    ▼
后端：检查缓存（是否存在有效的 PDF 缓存）
    │
    ├─ 缓存有效 → 直接返回 PDF 路径
    │
    └─ 缓存无效 → 执行转换
        │
        ▼
后端：调用 LibreOffice Service
    │
    ▼
LibreOffice：执行转换（soffice --headless --convert-to pdf）
    │
    ▼
后端：保存 PDF 到缓存目录
    │
    ▼
后端：返回 PDF 文件路径
    │
    ▼
前端：读取 PDF 文件为 base64
    │
    ▼
前端：创建 data URL（data:application/pdf;base64,{base64}）
    │
    ▼
前端：在 iframe 中加载 PDF
    │
    ▼
完成：用户可查看预览
```

### 4.2 缓存机制

**缓存策略：**
- **缓存位置**：应用数据目录下的 `cache/preview` 目录
- **缓存键**：文件路径 + 文件修改时间的 SHA256 哈希
- **缓存有效期**：1 小时
- **缓存清理**：文件修改后自动清除缓存

**缓存实现：**
```rust
// 伪代码
fn get_cache_key(file_path: &Path, modified_time: SystemTime) -> String {
    let content = format!("{}:{}", file_path.display(), modified_time);
    let hash = sha256(content);
    format!("{}.pdf", hash)
}

fn is_cache_valid(cache_path: &Path) -> bool {
    if !cache_path.exists() {
        return false;
    }
    let cache_age = get_file_age(cache_path);
    cache_age < Duration::from_secs(3600) // 1小时
}
```

### 4.3 预览组件架构

**统一预览组件架构：**

```typescript
// 基础预览组件接口
interface BasePreviewProps {
  filePath: string;
  fileType: 'docx' | 'excel' | 'presentation';
}

// 预览组件实现
const BasePreview: React.FC<BasePreviewProps> = ({ filePath, fileType }) => {
  // 1. 调用 Tauri 命令转换文档为 PDF
  const pdfUrl = await invoke<string>(`preview_${fileType}_as_pdf`, { path: filePath });
  
  // 2. 读取 PDF 为 base64
  const base64 = await invoke<string>('read_file_as_base64', { path: pdfUrl });
  
  // 3. 创建 data URL
  const dataUrl = `data:application/pdf;base64,${base64}`;
  
  // 4. 在 iframe 中加载 PDF
  return (
    <iframe
      src={dataUrl}
      className="w-full h-full border-0"
      title={`${fileType} 预览`}
    />
  );
};
```

**特定预览组件：**
- `DocxPdfPreview.tsx`：DOCX 预览组件（已实现）
- `ExcelPreview.tsx`：Excel 预览组件（待开发）
- `PresentationPreview.tsx`：演示文稿预览组件（待开发）

### 4.4 引用功能实现

**引用功能架构：**

```typescript
// 引用服务
class ReferenceService {
  // 生成引用格式
  generateReference(filePath: string, fileType: string, selection: Selection): string {
    const fileName = getFileName(filePath);
    const location = this.getLocation(fileType, selection);
    return `@${fileName}!${location}`;
  }
  
  // 获取位置信息
  getLocation(fileType: string, selection: Selection): string {
    switch (fileType) {
      case 'docx':
        return `第${this.getPageNumber(selection)}页`;
      case 'excel':
        return `${this.getSheetName(selection)}!${this.getCellAddress(selection)}`;
      case 'presentation':
        return `幻灯片${this.getSlideNumber(selection)}`;
    }
  }
  
  // 复制引用到剪贴板
  async copyReference(reference: string): Promise<void> {
    await navigator.clipboard.writeText(reference);
  }
}
```

**引用按钮组件：**

```typescript
// 引用按钮组件
const ReferenceButton: React.FC<{ selection: Selection }> = ({ selection }) => {
  const handleReference = async () => {
    const reference = referenceService.generateReference(filePath, fileType, selection);
    await referenceService.copyReference(reference);
    showToast('已复制引用');
  };
  
  return (
    <button onClick={handleReference}>
      引用
    </button>
  );
};
```

### 4.5 导航功能实现

**工作表导航（Excel）：**

```typescript
// 工作表导航组件
const SheetNavigation: React.FC<{ sheets: Sheet[], currentSheet: number }> = ({ sheets, currentSheet }) => {
  const handleSheetClick = (sheetIndex: number) => {
    const pdfPage = getPdfPageForSheet(sheetIndex);
    // 跳转到 PDF 对应页面
    iframe.contentWindow.postMessage({ type: 'gotoPage', page: pdfPage }, '*');
  };
  
  return (
    <div className="sheet-tabs">
      {sheets.map((sheet, index) => (
        <button
          key={index}
          onClick={() => handleSheetClick(index)}
          className={index === currentSheet ? 'active' : ''}
        >
          {sheet.name}
        </button>
      ))}
    </div>
  );
};
```

**幻灯片导航（演示文稿）：**

```typescript
// 幻灯片导航组件
const SlideNavigation: React.FC<{ slides: Slide[], currentSlide: number }> = ({ slides, currentSlide }) => {
  const handleSlideClick = (slideIndex: number) => {
    const pdfPage = slideIndex + 1; // 每张幻灯片对应一页 PDF
    // 跳转到 PDF 对应页面
    iframe.contentWindow.postMessage({ type: 'gotoPage', page: pdfPage }, '*');
  };
  
  return (
    <div className="slide-thumbnails">
      {slides.map((slide, index) => (
        <div
          key={index}
          onClick={() => handleSlideClick(index)}
          className={index === currentSlide ? 'active' : ''}
        >
          <img src={slide.thumbnail} alt={`幻灯片 ${index + 1}`} />
          <span>{index + 1}</span>
        </div>
      ))}
    </div>
  );
};
```

---

## 五、技术选型对比

### 5.1 文档转换方案对比

| 方案 | 格式支持 | 转换质量 | 性能 | 稳定性 | 维护成本 | 推荐度 |
|------|---------|---------|------|--------|---------|--------|
| **LibreOffice CLI** | ✅ 全面 | ✅ 高（≥95%） | ✅ 良好 | ✅ 高 | ✅ 低 | ⭐⭐⭐⭐⭐ |
| Pandoc | ⚠️ 部分（不支持 Excel/PPT） | ✅ 高 | ✅ 优秀 | ✅ 高 | ✅ 低 | ⭐⭐⭐ |
| Microsoft Office COM | ✅ 全面 | ✅ 高 | ⚠️ 一般 | ⚠️ 一般 | ⚠️ 高 | ⭐⭐ |
| 在线转换 API | ✅ 全面 | ✅ 高 | ⚠️ 依赖网络 | ⚠️ 一般 | ⚠️ 高 | ⭐⭐ |

**结论：LibreOffice CLI 是最佳选择**

### 5.2 预览渲染方案对比

| 方案 | 交互功能 | 性能 | 代码复杂度 | 维护成本 | 推荐度 |
|------|---------|------|-----------|---------|--------|
| **PDF + 浏览器原生** | ✅ 完整（原生支持） | ✅ 最优 | ✅ 简单 | ✅ 低 | ⭐⭐⭐⭐⭐ |
| PDF.js Canvas | ⚠️ 部分（需自定义） | ⚠️ 一般 | ⚠️ 复杂 | ⚠️ 高 | ⭐⭐⭐ |
| PDF.js SVG | ⚠️ 部分（需自定义） | ⚠️ 较差 | ⚠️ 复杂 | ⚠️ 高 | ⭐⭐ |
| 直接渲染 HTML | ❌ 不支持 | ✅ 优秀 | ⚠️ 复杂 | ⚠️ 高 | ⭐ |

**结论：PDF + 浏览器原生查看器是最佳选择**

### 5.3 CSV 预览方案对比

| 方案 | 预览效果 | 性能 | 开发成本 | 维护成本 | 引用功能 | 推荐度 |
|------|---------|------|---------|---------|---------|--------|
| PDF 转换（统一方案） | ⚠️ 一般（格式可能丢失） | ⚠️ 一般（需要转换） | ✅ 低（复用） | ✅ 低 | ❌ 困难（无法获取单元格位置） | ⭐⭐⭐ |
| **直接解析 HTML 表格** | ✅ 优秀（精确控制） | ✅ 优秀（直接解析） | ⚠️ 中（需开发，2天） | ⚠️ 中 | ✅ 简单（直接获取） | ⭐⭐⭐⭐⭐ |

**结论：CSV 应该使用独立的技术架构（直接解析为 HTML 表格）**

**理由：**
1. CSV 格式简单，解析成本低（使用 papaparse，0.5 天）
2. 预览效果优秀，用户体验好（HTML 表格精确控制样式）
3. 引用功能实现简单（可以直接获取单元格位置 A1、B2 等）
4. 性能优秀（无需转换，直接解析，加载速度快）
5. 开发成本不高（总计 2 天）

**详细分析见：** `CSV预览技术方案分析.md`

---

## 六、技术风险与应对

### 6.1 技术风险

**风险1：LibreOffice 转换质量不稳定**
- **风险等级**：低
- **应对措施**：
  - 使用稳定版本的 LibreOffice
  - 测试多种文件格式，确保转换质量
  - 提供错误提示和重试机制

**风险2：大文件转换性能问题**
- **风险等级**：中
- **应对措施**：
  - 实现缓存机制，避免重复转换
  - 异步转换，不阻塞主线程
  - 显示转换进度，提升用户体验
  - 限制文件大小（≤ 100MB）

**风险3：浏览器原生 PDF 查看器兼容性**
- **风险等级**：低
- **应对措施**：
  - 主流浏览器（Chrome、Firefox、Safari、Edge）均支持
  - 使用 data URL 方式，兼容性更好
  - 提供降级方案（如需要）

**风险4：引用功能实现复杂度**
- **风险等级**：中
- **应对措施**：
  - MVP 1.0 实现基础引用功能
  - 使用 Selection API，浏览器原生支持
  - 逐步优化和完善

### 6.2 性能优化

**转换性能优化：**
- ✅ 缓存机制：避免重复转换
- ✅ 异步转换：不阻塞主线程
- ✅ 进度反馈：提升用户体验
- ✅ 文件大小限制：≤ 100MB

**预览性能优化：**
- ✅ 浏览器原生渲染：性能最优
- ✅ data URL 方式：避免文件 I/O
- ✅ 懒加载：按需加载预览
- ✅ 内存管理：及时释放资源

---

## 七、技术实现清单

### 7.1 后端实现（Rust）

**LibreOffice Service 扩展：**
- ✅ `convert_docx_to_pdf`（已实现）
- 🔴 `convert_excel_to_pdf`（待开发）
- 🔴 `convert_presentation_to_pdf`（待开发）

**Tauri 命令扩展：**
- ✅ `preview_docx_as_pdf`（已实现）
- 🔴 `preview_excel_as_pdf`（待开发）
- 🔴 `preview_presentation_as_pdf`（待开发）

**缓存机制：**
- ✅ PDF 缓存（已实现）
- ✅ 缓存清理（已实现）

### 7.2 前端实现（React + TypeScript）

**预览组件：**
- ✅ `DocxPdfPreview.tsx`（已实现）
- 🔴 `ExcelPreview.tsx`（待开发，PDF 转换）
- 🔴 `PresentationPreview.tsx`（待开发，PDF 转换）
- 🔴 `CsvPreview.tsx`（待开发，**独立方案：直接解析为 HTML 表格**）

**引用功能：**
- 🔴 `ReferenceService.ts`（待开发）
- 🔴 `ReferenceButton.tsx`（待开发）

**导航功能：**
- 🔴 `SheetNavigation.tsx`（待开发，P1）
- 🔴 `SlideNavigation.tsx`（待开发，P1）

**文件类型识别：**
- ✅ `getFileType`（已实现）
- 🔴 扩展支持 Excel 和演示文稿格式（待开发）

---

## 八、技术选型总结

### 8.1 核心技术栈

**文档转换：**
- ✅ **LibreOffice CLI（soffice）**：最佳选择，支持所有格式，转换质量高

**预览渲染：**
- ✅ **PDF + 浏览器原生查看器（iframe + data URL）**：最佳选择，性能最优，代码简洁

**引用功能：**
- ✅ **前端自定义实现（React + Selection API）**：必须实现，浏览器原生支持

**导航功能：**
- ✅ **前端自定义实现（React 组件 + PDF 页码映射）**：P1 功能，实现简单

### 8.2 技术优势

**统一性：**
- ✅ 三种预览功能使用统一的技术方案
- ✅ 代码高度可复用（90%+）
- ✅ 维护成本低

**稳定性：**
- ✅ 使用成熟稳定的技术栈
- ✅ LibreOffice 经过大量项目验证
- ✅ 浏览器原生功能稳定可靠

**性能：**
- ✅ 满足性能需求（首次 < 15 秒，缓存后 < 3 秒）
- ✅ 浏览器原生渲染，性能最优
- ✅ 缓存机制，避免重复转换

**准确性：**
- ✅ 格式还原准确率 ≥ 95%
- ✅ 数据准确性 100%
- ✅ 布局还原准确率 ≥ 90%

### 8.3 技术限制

**浏览器原生限制：**
- ⚠️ 不支持自定义页面跳转输入框（P2）
- ⚠️ 不支持自定义搜索范围选择（P2）
- ⚠️ 不支持自定义缩放控制（P2）

**PDF 预览限制：**
- ⚠️ 无法直接显示工作表/幻灯片结构（需通过页码映射）
- ⚠️ 不支持动画播放（演示文稿，静态预览）

**解决方案：**
- MVP 1.0：使用浏览器原生功能，满足核心需求
- P1/P2：如需自定义功能，可考虑使用 PDF.js（但会失去原生优势）

---

## 九、技术演进路径

### 9.1 MVP 1.0（当前版本）

**技术方案：**
- ✅ LibreOffice CLI 转换文档为 PDF（DOCX/Excel/演示文稿）
- ✅ 浏览器原生 PDF 查看器渲染（DOCX/Excel/演示文稿）
- ✅ CSV 直接解析为 HTML 表格 + 虚拟滚动（CSV）
- ✅ 基础引用功能（所有格式）
- ✅ PDF 页码映射工作表/幻灯片（Excel/演示文稿）

**性能优化：**
- ✅ CSV 虚拟滚动（@tanstack/react-virtual）
- ✅ CSV 流式解析（papaparse 流式模式）

**实现状态：**
- ✅ DOCX 预览：已实现
- 🔴 Excel 预览：待开发
- 🔴 演示文稿预览：待开发
- 🔴 引用功能：待开发

### 9.2 P1 优化（后续版本）

**技术方案：**
- ✅ 工作表标签栏组件
- ✅ 幻灯片缩略图组件
- ✅ 引用功能优化
- ✅ 全屏预览模式

### 9.3 P2 优化（后续版本）

**技术方案：**
- ✅ CSV 表格排序功能
- ✅ CSV 表格筛选功能
- ✅ CSV 列宽调整功能
- ✅ 自定义页面跳转输入框（所有格式）
- ✅ 自定义搜索范围选择（所有格式）
- ✅ 自定义缩放控制（所有格式）

**详细优化方案见：** `预览功能技术优化分析.md`

---

## 十、总结

### 10.1 技术选型结论

**文档转换：LibreOffice CLI**
- ✅ 最佳选择：支持所有格式，转换质量高，稳定可靠

**预览渲染：PDF + 浏览器原生查看器**
- ✅ 最佳选择：性能最优，代码简洁，维护成本低

**引用功能：前端自定义实现**
- ✅ 必须实现：使用 Selection API，浏览器原生支持

**导航功能：前端自定义实现**
- ✅ P1 功能：使用 React 组件 + PDF 页码映射

### 10.2 技术优势

1. **统一性**：DOCX、Excel、演示文稿使用统一的技术方案（PDF 转换）
2. **针对性**：CSV 使用独立方案（直接解析），更适合 CSV 格式特点
3. **稳定性**：使用成熟稳定的技术栈
4. **性能**：满足性能需求，浏览器原生渲染最优
5. **准确性**：格式还原准确率 ≥ 95%，数据准确性 100%
6. **可维护性**：代码简洁，维护成本低

### 10.3 技术限制

1. **浏览器原生限制**：不支持部分自定义功能（P2）
2. **PDF 预览限制**：无法直接显示工作表/幻灯片结构（需通过页码映射）
3. **动画支持**：演示文稿不支持动画播放（静态预览）
4. **CSV 大文件**：大 CSV 文件需要实现虚拟滚动或分页加载

### 10.4 技术演进

- **MVP 1.0**：
  - DOCX、Excel、演示文稿：PDF 转换 + 浏览器原生查看器
  - CSV：直接解析为 HTML 表格（独立方案）
- **P1**：添加工作表/幻灯片导航组件
- **P2**：CSV 表格排序、筛选、列宽调整等扩展功能

---

**文档版本**：v1.0  
**创建日期**：2025年  
**状态**：技术框架，待实现

