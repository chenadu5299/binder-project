# 预览功能开发计划

## 文档信息

- **文档版本**：v2.0
- **创建日期**：2025年
- **文档性质**：开发计划
- **适用范围**：Binder 预览功能 MVP 1.0
- **对应需求文档**：`预览功能需求文档.md`
- **对应技术文档**：`预览功能技术框架.md`

---

## 一、开发目标

### 1.1 总体目标

**完成 DOCX、Excel（含 CSV）、演示文稿的统一预览功能，提供高质量、交互友好的文档预览体验。**

**技术方案：**
- **DOCX/Excel（XLSX/XLS/ODS）/演示文稿**：LibreOffice → PDF → 浏览器原生查看器
- **CSV**：直接解析 → HTML 表格 + 虚拟滚动（独立方案，性能优秀）

### 1.2 功能范围

**P0（必须实现，MVP 1.0）：**
- ✅ DOCX 预览（已实现，需补充引用功能）
- 🔴 Excel 预览（待开发）
  - XLSX/XLS/ODS：PDF 转换方案
  - CSV：独立方案（直接解析为 HTML 表格 + 虚拟滚动）
- 🔴 演示文稿预览（待开发）
- 🔴 引用功能（所有格式统一）

**P1（重要功能，尽量实现）：**
- 🔴 工作表标签栏组件（Excel）
- 🔴 幻灯片缩略图组件（演示文稿）
- 🔴 复制成功提示

**P2（增强功能，后续版本）：**
- 🟡 CSV 表格排序、筛选、列宽调整
- 🟡 多工作表切换优化
- 🟡 自定义页面跳转输入框
- 🟡 自定义搜索范围选择
- 🟡 自定义缩放控制

---

## 二、开发阶段规划

### 2.1 Phase 1：Excel 和演示文稿预览（P0）

**目标：** 实现 Excel、CSV 和演示文稿的基础预览功能

**时间：** 10 天（约 2 周）

**任务清单：**

#### Day 0：前置任务（依赖安装）

**前置任务：依赖安装**
- **任务**：安装必要的 npm 包
- **命令**：
  ```bash
  npm install papaparse @tanstack/react-virtual
  ```
- **工作量**：0.1 天
- **负责人**：前端开发
- **状态**：🔴 待开发

#### Day 1-2：基础架构扩展

**任务1：文件类型定义扩展**
- **文件**：`src/types/file.ts`
- **任务**：
  - 添加 `excel` 类型
  - 添加 `presentation` 类型
- **工作量**：0.5 天
- **负责人**：前端开发
- **状态**：🔴 待开发

**任务2：文件服务扩展**
- **文件**：`src/services/documentService.ts`
- **任务**：
  - 扩展 `getFileType` 函数识别 Excel 和演示文稿格式
  - 添加文件打开策略（预览模式）
- **工作量**：0.5 天
- **负责人**：前端开发
- **状态**：🔴 待开发

**任务3：LibreOffice 服务扩展**
- **文件**：`src-tauri/src/services/libreoffice_service.rs`
- **任务**：
  - 添加 `convert_excel_to_pdf` 方法（XLSX、XLS、ODS）
  - 添加 `convert_presentation_to_pdf` 方法
  - 复用现有 `convert_docx_to_pdf` 逻辑
  - ⚠️ **注意**：CSV 不使用 LibreOffice 转换，使用前端直接解析
- **工作量**：1-2 天
- **负责人**：后端开发
- **状态**：🔴 待开发

#### Day 3-4：Tauri 命令和 Excel 预览（XLSX/XLS/ODS）

**任务4：Tauri 命令添加**
- **文件**：`src-tauri/src/commands/file_commands.rs`
- **任务**：
  - 添加 `preview_excel_as_pdf` 命令（XLSX、XLS、ODS）
  - 添加 `preview_presentation_as_pdf` 命令
  - 复用现有 `preview_docx_as_pdf` 逻辑
  - ⚠️ **注意**：CSV 不需要 Tauri 命令，前端直接读取文件
- **工作量**：1 天
- **负责人**：后端开发
- **状态**：🔴 待开发

**任务5：Excel 预览组件开发（XLSX/XLS/ODS）**
- **文件**：`src/components/Editor/ExcelPreview.tsx`（新建）
- **任务**：
  - 复用 `DocxPdfPreview` 组件架构
  - 实现 Excel 文件预览（XLSX、XLS、ODS）
  - 基础多工作表支持（PDF 页码映射）
  - 实现加载状态显示（转换进度）
  - 实现错误处理和提示
  - 实现暗色模式适配
- **工作量**：2 天
- **负责人**：前端开发
- **状态**：🔴 待开发
- **功能清单**：
  - ✅ PDF 转换和加载
  - ✅ 文本选择、复制、搜索（浏览器原生）
  - ✅ 缩放、打印（浏览器原生）
  - ✅ 加载状态显示
  - ✅ 错误处理
  - ✅ 暗色模式适配

**任务5.1：CSV 预览组件开发（独立方案）**
- **文件**：`src/components/Editor/CsvPreview.tsx`（新建）
- **任务**：
  - 实现 CSV 直接解析为 HTML 表格
  - 集成虚拟滚动（@tanstack/react-virtual）
  - 实现流式解析（papaparse 流式模式）
  - 实现单元格位置信息（A1、B2 等）
  - 实现基础引用功能
  - 实现加载状态显示（解析进度）
  - 实现错误处理和提示（格式兼容性）
  - 实现暗色模式适配
  - 实现表格样式（网格线、列宽、对齐）
- **工作量**：3 天
- **负责人**：前端开发
- **状态**：🔴 待开发
- **技术栈**：
  - CSV 解析：`papaparse`（支持流式解析）
  - 虚拟滚动：`@tanstack/react-virtual`（轻量级 < 5KB）
  - 表格渲染：React 组件 + HTML `<table>`
- **依赖安装**：
  - `npm install papaparse @tanstack/react-virtual`
- **功能清单**：
  - ✅ CSV 解析和渲染
  - ✅ 虚拟滚动（大文件优化）
  - ✅ 流式解析（进度反馈）
  - ✅ 单元格位置信息（A1、B2 等）
  - ✅ 文本选择、复制（浏览器原生）
  - ✅ 搜索功能（浏览器原生 Cmd+F）
  - ✅ 加载状态显示
  - ✅ 错误处理（格式兼容性）
  - ✅ 暗色模式适配

#### Day 5-7：CSV 预览组件开发

（任务5.1已在上面定义，此处不再重复）

#### Day 8-9：演示文稿预览

**任务6：演示文稿预览组件开发**
- **文件**：`src/components/Editor/PresentationPreview.tsx`（新建）
- **任务**：
  - 复用 `DocxPdfPreview` 组件架构
  - 实现演示文稿文件预览
  - 基础幻灯片切换（PDF 页码映射）
  - 实现加载状态显示（转换进度）
  - 实现错误处理和提示
  - 实现暗色模式适配
- **工作量**：2-3 天
- **负责人**：前端开发
- **状态**：🔴 待开发
- **功能清单**：
  - ✅ PDF 转换和加载
  - ✅ 文本选择、复制、搜索（浏览器原生）
  - ✅ 缩放、打印（浏览器原生）
  - ✅ 幻灯片导航（上一张/下一张，PDF 页码）
  - ✅ 加载状态显示
  - ✅ 错误处理
  - ✅ 暗色模式适配

#### Day 10：集成和测试

**任务7：编辑器面板集成**
- **文件**：`src/components/Editor/EditorPanel.tsx`
- **任务**：
  - 添加 Excel 预览支持（XLSX/XLS/ODS → ExcelPreview，CSV → CsvPreview）
  - 添加演示文稿预览支持
  - 测试文件类型识别和路由
- **工作量**：0.5 天
- **负责人**：前端开发
- **状态**：🔴 待开发

**任务8：功能测试**
- **任务**：
  - Excel 预览功能测试（XLSX、XLS、ODS）
  - CSV 预览功能测试（虚拟滚动、流式解析）
  - 演示文稿预览功能测试
  - 兼容性测试（不同格式文件）
  - 性能测试（大文件加载，特别是大 CSV 文件）
- **工作量**：0.5 天
- **负责人**：测试工程师
- **状态**：🔴 待开发

---

### 2.2 Phase 2：引用功能和交互优化（P1）

**目标：** 实现统一的引用功能，优化用户体验

**时间：** 4-7 天（约 1 周）

**任务清单：**

#### Day 9-11：引用功能开发

**任务9：引用服务开发**
- **文件**：`src/services/referenceService.ts`（新建）
- **任务**：
  - 实现引用格式生成（DOCX、Excel、CSV、演示文稿）
  - 实现引用格式解析
  - 实现引用跳转功能
  - CSV 引用：直接获取单元格位置（A1、B2 等）
  - Excel 引用：工作表名称 + 页码（简化方案）
- **工作量**：2-3 天
- **负责人**：前端开发
- **状态**：🔴 待开发

**任务10：引用按钮组件开发**
- **文件**：`src/components/Editor/ReferenceButton.tsx`（新建）
- **任务**：
  - 实现选中文本后显示引用按钮（悬浮或工具栏）
  - 实现引用格式生成和复制
  - 实现引用预览（鼠标悬停显示引用内容）
  - 实现复制成功提示（"已复制引用"）
  - 实现引用按钮样式和动画
- **工作量**：1-2 天
- **负责人**：前端开发
- **状态**：🔴 待开发
- **功能清单**：
  - ✅ 文本选择监听
  - ✅ 引用按钮显示/隐藏
  - ✅ 引用格式生成（DOCX、Excel、CSV、演示文稿）
  - ✅ 引用复制到剪贴板
  - ✅ 复制成功提示
  - ✅ 引用预览（悬浮显示）

#### Day 14-15：工作表标签栏和幻灯片导航

**任务11：工作表标签栏组件开发（P1）**
- **文件**：`src/components/Editor/SheetNavigation.tsx`（新建）
- **任务**：
  - 实现工作表标签栏（底部）
  - 实现点击标签切换工作表（跳转到对应 PDF 页面）
  - 实现标签滚动（工作表较多时，左右滚动）
  - 实现当前工作表高亮
  - 实现工作表名称显示
  - 实现工作表数量显示
  - 集成到 ExcelPreview 组件
- **工作量**：1-2 天
- **负责人**：前端开发
- **状态**：🔴 待开发
- **功能清单**：
  - ✅ 工作表标签栏 UI
  - ✅ 标签点击切换（PDF 页码映射）
  - ✅ 标签滚动（左右滚动按钮）
  - ✅ 当前工作表高亮
  - ✅ 工作表名称显示
  - ✅ 工作表数量显示（如"1/5"）

**任务11.1：幻灯片导航组件开发（P1）**
- **文件**：`src/components/Editor/SlideNavigation.tsx`（新建）
- **任务**：
  - 实现幻灯片缩略图列表（侧边栏）
  - 实现点击切换幻灯片（跳转到对应 PDF 页面）
  - 实现上一张/下一张按钮
  - 实现幻灯片跳转（输入幻灯片编号）
  - 实现当前幻灯片高亮
  - 实现幻灯片编号显示（如"1/20"）
  - 实现缩略图滚动（上下滚动）
  - 集成到 PresentationPreview 组件
- **工作量**：1-2 天
- **负责人**：前端开发
- **状态**：🔴 待开发
- **功能清单**：
  - ✅ 幻灯片缩略图列表 UI（侧边栏）
  - ✅ 缩略图点击切换（PDF 页码映射）
  - ✅ 上一张/下一张按钮
  - ✅ 幻灯片跳转输入框
  - ✅ 当前幻灯片高亮
  - ✅ 幻灯片编号显示
  - ✅ 缩略图滚动（上下滚动按钮）

#### Day 16：集成和测试

**任务12：引用功能集成**
- **任务**：
  - 在 DOCX、Excel、CSV、演示文稿预览中集成引用功能
  - 集成 ReferenceButton 组件到所有预览组件
  - 测试引用格式生成和跳转
  - CSV 引用测试（单元格位置获取）
  - 引用跳转功能测试（点击引用打开文档并定位）
- **工作量**：0.5 天
- **负责人**：前端开发
- **状态**：🔴 待开发
- **功能清单**：
  - ✅ DOCX 引用集成（`@文件名.docx!第1页`）
  - ✅ Excel 引用集成（`@文件名.xlsx!Sheet1!第1页`）
  - ✅ CSV 引用集成（`@文件名.csv!A1`）
  - ✅ 演示文稿引用集成（`@文件名.pptx!幻灯片1`）
  - ✅ 引用跳转功能

**任务13：功能测试**
- **任务**：
  - 引用功能测试（所有格式）
  - 工作表标签栏测试
  - 幻灯片导航测试
  - 复制成功提示测试
  - 加载状态显示测试
  - 错误处理测试
  - 暗色模式适配测试
  - 用户体验测试
- **工作量**：0.5 天
- **负责人**：测试工程师
- **状态**：🔴 待开发

---

### 2.3 Phase 3：优化功能（P2）

**目标：** 优化预览体验和性能

**时间：** 3.5-7 天（约 1 周）

**任务清单：**

**任务14：CSV 表格交互功能增强（P2）**
- **文件**：`src/components/Editor/CsvPreview.tsx`
- **任务**：
  - 实现列排序功能
  - 实现列筛选功能
  - 实现列宽调整功能
- **工作量**：2-3 天
- **优先级**：P2
- **状态**：🟡 待优化

**任务15：工作表标签栏组件（P1）**
- **文件**：`src/components/Editor/SheetNavigation.tsx`（新建）
- **任务**：
  - 实现工作表标签栏（底部）
  - 实现点击标签切换工作表
  - 实现标签滚动（工作表较多时）
  - 实现当前工作表高亮
- **工作量**：1-2 天
- **优先级**：P1
- **状态**：🔴 待开发

**任务16：缩放控制优化（P2）**
- **文件**：预览组件
- **任务**：
  - 添加自定义缩放控制（工具栏）
  - 显示当前缩放比例（如"100%"）
  - 实现缩放按钮（放大/缩小/重置）
  - 实现缩放滑块（拖拽调整）
  - 实现自适应缩放（适应窗口大小）
- **工作量**：0.5-1 天
- **优先级**：P2
- **状态**：🟡 待优化

**任务16.1：复制成功提示（P1）**
- **文件**：预览组件
- **任务**：
  - 实现复制成功提示（"已复制到剪贴板"）
  - 实现提示动画和自动消失
  - 集成到所有预览组件
- **工作量**：0.5 天
- **优先级**：P1
- **状态**：🔴 待开发

**任务16.2：全屏预览模式（P1）**
- **文件**：预览组件
- **任务**：
  - 实现全屏预览模式（F11 或按钮）
  - 实现全屏退出（ESC 或按钮）
  - 实现全屏工具栏（最小化显示）
  - 集成到所有预览组件
- **工作量**：1 天
- **优先级**：P1
- **状态**：🔴 待开发

**任务17：性能优化（P2）**
- **文件**：多个文件
- **任务**：
  - 优化缓存策略（缓存有效期、清理机制）
  - 添加加载进度显示（转换进度、解析进度）
  - 优化大文件加载（分块加载、懒加载）
  - 优化内存占用（及时释放资源）
  - 优化 CSV 大文件处理（虚拟滚动性能调优）
- **工作量**：1-2 天
- **优先级**：P2
- **状态**：🟡 待优化

**任务17.1：错误处理完善（P0）**
- **文件**：所有预览组件
- **任务**：
  - 实现文件无法打开的错误提示
  - 实现转换失败的错误提示
  - 实现文件损坏的错误提示
  - 实现错误重试功能
  - 实现友好的错误信息显示
- **工作量**：0.5 天
- **优先级**：P0
- **状态**：🔴 待开发

**任务17.2：暗色模式适配（P0）**
- **文件**：所有预览组件
- **任务**：
  - 实现暗色模式检测
  - 实现预览组件暗色模式样式
  - 实现工具栏暗色模式样式
  - 实现 CSV 表格暗色模式样式
  - 测试暗色模式下的可读性
- **工作量**：0.5 天
- **优先级**：P0
- **状态**：🔴 待开发

---

## 三、开发里程碑

### 3.1 Milestone 1：基础预览功能（Week 1-2）

**目标：** 完成 Excel 和演示文稿的基础预览功能

**交付物：**
- ✅ Excel 预览组件（XLSX/XLS/ODS，PDF 转换）
- ✅ CSV 预览组件（独立方案，HTML 表格 + 虚拟滚动）
- ✅ 演示文稿预览组件
- ✅ LibreOffice 服务扩展
- ✅ Tauri 命令扩展
- ✅ 编辑器面板集成

**验收标准：**
- Excel 文件（XLSX、XLS、ODS）可以正常预览
- CSV 文件可以正常预览（虚拟滚动性能优秀）
- 演示文稿文件可以正常预览
- 支持文本选择、复制、搜索
- 支持缩放和打印
- 加载状态显示正常
- 错误处理完善
- 暗色模式适配正常
- 性能满足需求（加载时间 < 15 秒，CSV 大文件 < 3 秒）

**时间：** Day 1-10（10 天）

### 3.2 Milestone 2：交互功能（Week 3）

**目标：** 完成引用功能和幻灯片导航

**交付物：**
- ✅ 引用服务
- ✅ 引用按钮组件
- ✅ 幻灯片导航组件
- ✅ 引用功能集成

**验收标准：**
- 引用功能在 DOCX、Excel、CSV、演示文稿中正常工作
- 引用格式正确生成和解析
- 引用跳转功能正常
- CSV 引用功能正常（单元格位置获取）
- 工作表标签栏功能正常（Excel）
- 幻灯片导航功能正常（演示文稿）
- 复制成功提示正常
- 全屏预览模式正常（P1）

**时间：** Day 11-16（6 天）

### 3.3 Milestone 3：优化功能（Week 4）

**目标：** 优化预览体验和性能

**交付物：**
- ✅ CSV 预览优化（可选）
- ✅ 多工作表切换优化
- ✅ 缩放控制优化
- ✅ 性能优化

**验收标准：**
- CSV 表格排序、筛选、列宽调整功能正常
- 自定义缩放控制功能正常
- 自定义页面跳转输入框功能正常
- 自定义搜索范围选择功能正常
- 预览体验明显提升
- 性能指标满足要求
- 用户反馈良好

**时间：** Day 17-23（3.5-7 天）

---

## 四、资源分配

### 4.1 人员配置

**前端开发：**
- 依赖安装（0.1 天）
- 基础架构扩展（文件类型、文件服务，1 天）
- Excel 预览组件开发（XLSX/XLS/ODS，2 天）
- CSV 预览组件开发（独立方案，3 天）
- 演示文稿预览组件开发（2-3 天）
- 编辑器面板集成（0.5 天）
- 引用功能开发（3-5 天，P1）
- 引用按钮组件开发（1-2 天，P1）
- 工作表标签栏组件开发（1-2 天，P1）
- 幻灯片导航组件开发（1-2 天，P1）
- 复制成功提示（0.5 天，P1）
- 全屏预览模式（1 天，P1）
- 错误处理完善（0.5 天，P0）
- 暗色模式适配（0.5 天，P0）
- **P0 总计：9.1 天**
- **P1 总计：7-11.5 天**
- **总计：16.1-20.6 天**

**后端开发：**
- LibreOffice 服务扩展（1-2 天）
- Tauri 命令扩展（1 天）
- **总计：2-3 天**

**测试工程师：**
- 功能测试（1 天）
- 兼容性测试（0.5 天）
- 性能测试（0.5 天）
- **总计：2 天**

### 4.2 时间安排

**Phase 1（P0）：** 10 天（约 2 周）
  - 基础架构扩展：1 天
  - Excel/CSV/演示文稿预览：7 天
  - 错误处理和暗色模式：1 天
  - 集成和测试：1 天

**Phase 2（P1）：** 6-7 天（约 1 周）
  - 引用功能：3-5 天
  - 工作表标签栏和幻灯片导航：2-4 天
  - 复制成功提示和全屏预览：1.5 天
  - 集成和测试：0.5 天

**Phase 3（P2）：** 3.5-7 天（约 1 周）
  - CSV 表格交互功能：2-3 天
  - 缩放控制优化：0.5-1 天
  - 性能优化：1-2 天

**总计：** 19.5-24 天（约 4-5 周）

---

## 五、风险控制

### 5.1 技术风险

**风险1：LibreOffice 转换 Excel 可能不准确**
- **应对**：测试多种 Excel 文件，确保格式还原准确
- **降级方案**：如果转换不准确，考虑使用其他转换库

**风险2：多工作表 PDF 映射可能不准确**
- **应对**：测试多工作表文件，确保页码映射正确
- **降级方案**：如果映射不准确，考虑使用其他方案

**风险3：CSV 大文件虚拟滚动性能问题**
- **应对**：使用成熟的虚拟滚动库（@tanstack/react-virtual），实现流式解析
- **降级方案**：限制 CSV 文件大小（如 50MB），大文件提示用户

**风险4：CSV 格式兼容性问题**
- **应对**：使用成熟的 CSV 解析库（papaparse），自动检测分隔符和编码
- **降级方案**：提供错误提示，允许用户手动选择分隔符

### 5.2 进度风险

**风险1：开发时间可能超出预期**
- **应对**：预留缓冲时间（20%）
- **降级方案**：优先实现 P0 功能，P1/P2 功能可延期

**风险2：测试时间可能不足**
- **应对**：提前准备测试用例，并行测试
- **降级方案**：分阶段测试，确保核心功能稳定

### 5.3 质量风险

**风险1：预览准确性可能不达标**
- **应对**：严格测试，确保格式还原准确率 ≥ 95%
- **降级方案**：明确告知用户功能限制

**风险2：性能可能不达标**
- **应对**：优化缓存策略，添加加载进度显示
- **降级方案**：限制文件大小（如 50MB）

---

## 六、质量保证

### 6.1 测试计划

**功能测试：**
- Excel 预览功能测试（XLSX、XLS、ODS）
- CSV 预览功能测试（虚拟滚动、流式解析、引用功能）
- 演示文稿预览功能测试
- 引用功能测试（所有格式）
- 交互功能测试（选中、复制、搜索、打印）

**兼容性测试：**
- 不同格式文件测试（XLSX、XLS、CSV、ODS、PPTX、PPT、PPSX、PPS、ODP）
- 不同大小文件测试（小文件 < 1MB、大文件 > 10MB、超大 CSV > 50MB）
- 不同 CSV 格式测试（分隔符：逗号、分号、制表符；编码：UTF-8、GBK）
- 不同操作系统测试（macOS、Windows、Linux）

**性能测试：**
- 加载时间测试（首次 < 15 秒，缓存后 < 3 秒）
- CSV 大文件测试（> 10MB，虚拟滚动性能）
- 内存占用测试（< 300MB，CSV 虚拟滚动 < 100MB）
- CPU 占用测试（加载时 < 50%，预览时 < 10%）

**用户体验测试：**
- 界面友好性测试
- 操作流畅性测试
- 错误处理测试

### 6.2 验收标准

**功能验收：**
- ✅ 所有 P0 功能完整实现
- ✅ 功能符合需求文档
- ✅ 功能交互符合设计要求

**性能验收：**
- ✅ 预览加载时间：首次 < 15 秒，缓存后 < 3 秒
- ✅ 格式还原准确率：≥ 95%
- ✅ 内存占用：< 300MB

**质量验收：**
- ✅ 无严重 Bug
- ✅ 错误处理完善
- ✅ 用户体验良好

---

## 七、交付清单

### 7.1 代码交付

**前端代码：**
- `src/components/Editor/ExcelPreview.tsx`（XLSX/XLS/ODS，PDF 转换）
- `src/components/Editor/CsvPreview.tsx`（CSV，独立方案，HTML 表格 + 虚拟滚动）[Debug] [vite] connecting... (client, line 495)
[Debug] [vite] connected. (client, line 618)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – Object (InlineChatInput.tsx, line 838)
Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🔍 InlineChatInput 组件已渲染 – Object (InlineChatInput.tsx, line 951)
Object
[Log] 📐 容器位置和大小: – Object (InlineChatInput.tsx, line 962)
Object
[Log] 🔍 欢迎页面显示状态: – Object (MainLayout.tsx, line 65)
Object
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – Object (InlineChatInput.tsx, line 838)
Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🔍 InlineChatInput 组件已渲染 – Object (InlineChatInput.tsx, line 951)
Object
[Log] 📐 容器位置和大小: – Object (InlineChatInput.tsx, line 962)
Object
[Log] 🔍 欢迎页面显示状态: – Object (MainLayout.tsx, line 65)
Object
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "auto", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🔍 InlineChatInput 组件已渲染 – {tabId: null, hasMessages: false, isStreaming: false, …} (InlineChatInput.tsx, line 951)
{tabId: null, hasMessages: false, isStreaming: false, referencesCount: 0, editorRefExists: true, …}Object
[Log] 📐 容器位置和大小: – {width: 381, height: 75, top: 173, …} (InlineChatInput.tsx, line 962)
{width: 381, height: 75, top: 173, left: 893, visible: true}Object
[Log] 🔧 初始化聊天流式响应事件监听 (ChatPanel.tsx, line 52)
[Log] 🔍 欢迎页面显示状态: – {showWelcomeDialog: false, currentWorkspace: "/Users/chenzhenqiang/Desktop/智能炒菜机器人解决方案/智能餐饮解决方案", hasTemporaryChats: false, …} (MainLayout.tsx, line 65)
{showWelcomeDialog: false, currentWorkspace: "/Users/chenzhenqiang/Desktop/智能炒菜机器人解决方案/智能餐饮解决方案", hasTemporaryChats: false, temporaryTabsCount: 0, shouldShowWelcome: false, …}Object
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🔍 InlineChatInput 组件已渲染 – {tabId: null, hasMessages: false, isStreaming: false, …} (InlineChatInput.tsx, line 951)
{tabId: null, hasMessages: false, isStreaming: false, referencesCount: 0, editorRefExists: true, …}Object
[Log] 📐 容器位置和大小: – {width: 381, height: 75, top: 173, …} (InlineChatInput.tsx, line 962)
{width: 381, height: 75, top: 173, left: 893, visible: true}Object
[Log] 🔧 初始化聊天流式响应事件监听 (ChatPanel.tsx, line 52)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 检测到文件系统变化，自动刷新文件树 (FileTree.tsx, line 60, x8)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Log] [EditorPanel] 渲染 Excel 表格预览，文件路径: – "/Users/chenzhenqiang/Desktop/智能炒菜机器人解决方案/智能餐饮解决方案/拜访团队.xlsx" (EditorPanel.tsx, line 463)
[Log] [EditorPanel] 渲染 Excel 表格预览，文件路径: – "/Users/chenzhenqiang/Desktop/智能炒菜机器人解决方案/智能餐饮解决方案/拜访团队.xlsx" (EditorPanel.tsx, line 463)
[Log] [EditorPanel] 渲染 Excel 表格预览，文件路径: – "/Users/chenzhenqiang/Desktop/智能炒菜机器人解决方案/智能餐饮解决方案/拜访团队.xlsx" (EditorPanel.tsx, line 463)
[Log] [EditorPanel] 渲染 Excel 表格预览，文件路径: – "/Users/chenzhenqiang/Desktop/智能炒菜机器人解决方案/智能餐饮解决方案/拜访团队.xlsx" (EditorPanel.tsx, line 463)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
[Log] ✅ [DEBUG] Window 和 Document 级别拖拽事件监听器已绑定（捕获阶段） (InlineChatInput.tsx, line 817)
[Log] ✅ 容器已找到，准备绑定拖拽事件监听器 – {containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, …} (InlineChatInput.tsx, line 838)
{containerClass: "inline-chat-input-container flex-shrink-0 border-t…ark:border-gray-700 p-4 bg-white dark:bg-gray-800", containerId: "", containerRect: DOMRect, zIndex: "9999", position: "relative", …}Object
[Log] 🎨 容器样式已更新用于调试：红色边框 + z-index: 9999 (InlineChatInput.tsx, line 857)
[Log] ✅ 拖拽事件监听器已绑定到容器 (InlineChatInput.tsx, line 911)
[Error] Warning: React has detected a change in the order of Hooks called by ExcelTablePreview. This will lead to bugs and errors if not fixed. For more information, read the Rules of Hooks: https://reactjs.org/link/rules-of-hooks

   Previous render            Next render
   ------------------------------------------------------
1. useState                   useState
2. useState                   useState
3. useState                   useState
4. useState                   useState
5. useState                   useState
6. useState                   useState
7. useState                   useState
8. useState                   useState
9. useState                   useState
10. useRef                    useRef
11. useRef                    useRef
12. useRef                    useRef
13. useMemo                   useMemo
14. useMemo                   useMemo
15. useMemo                   useMemo
16. useMemo                   useMemo
17. useReducer                useReducer
18. useState                  useState
19. useLayoutEffect           useLayoutEffect
20. useLayoutEffect           useLayoutEffect
21. useCallback               useCallback
22. useCallback               useCallback
23. useCallback               useCallback
24. useEffect                 useEffect
25. useCallback               useCallback
26. useEffect                 useEffect
27. undefined                 useEffect
   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

ExcelTablePreview@http://localhost:1420/src/components/Editor/ExcelTablePreview.tsx:23:38
Suspense
div
div
div
EditorPanel@http://localhost:1420/src/components/Editor/EditorPanel.tsx:78:44
div
div
div
MainLayout@http://localhost:1420/src/components/Layout/MainLayout.tsx:44:21
App@http://localhost:1420/src/App.tsx:23:34
ErrorBoundary@http://localhost:1420/src/components/Common/ErrorBoundary.tsx:7:10
	printWarning (chunk-ZTUR5KCH.js:521)
	error (chunk-ZTUR5KCH.js:505)
	warnOnHookMismatchInDev (chunk-ZTUR5KCH.js:11495)
	updateHookTypesDev (chunk-ZTUR5KCH.js:11465)
	useEffect (chunk-ZTUR5KCH.js:12702)
	ExcelTablePreview (ExcelTablePreview.tsx:283)
	renderWithHooks (chunk-ZTUR5KCH.js:11548)
	updateFunctionComponent (chunk-ZTUR5KCH.js:14582)
	beginWork$1 (chunk-ZTUR5KCH.js:19753)
	performUnitOfWork (chunk-ZTUR5KCH.js:19198)
	workLoopSync (chunk-ZTUR5KCH.js:19137)
	renderRootSync (chunk-ZTUR5KCH.js:19116)
	performConcurrentWorkOnRoot (chunk-ZTUR5KCH.js:18678:98)
	workLoop (chunk-ZTUR5KCH.js:197)
	flushWork (chunk-ZTUR5KCH.js:176)
	performWorkUntilDeadline (chunk-ZTUR5KCH.js:384)
[Error] Error: Rendered more hooks than during the previous render.
	updateWorkInProgressHook (chunk-ZTUR5KCH.js:11678:87)
	updateEffectImpl (chunk-ZTUR5KCH.js:12074)
	ExcelTablePreview (ExcelTablePreview.tsx:283)
	renderWithHooks (chunk-ZTUR5KCH.js:11548)
	updateFunctionComponent (chunk-ZTUR5KCH.js:14582)
	callCallback2 (chunk-ZTUR5KCH.js:3674)
	dispatchEvent
	invokeGuardedCallbackDev (chunk-ZTUR5KCH.js:3699)
	invokeGuardedCallback (chunk-ZTUR5KCH.js:3733)
	beginWork$1 (chunk-ZTUR5KCH.js:19765)
	performUnitOfWork (chunk-ZTUR5KCH.js:19198)
	workLoopSync (chunk-ZTUR5KCH.js:19137)
	renderRootSync (chunk-ZTUR5KCH.js:19116)
	performConcurrentWorkOnRoot (chunk-ZTUR5KCH.js:18678:98)
	workLoop (chunk-ZTUR5KCH.js:197)
	flushWork (chunk-ZTUR5KCH.js:176)
	performWorkUntilDeadline (chunk-ZTUR5KCH.js:384)
[Error] Error: Rendered more hooks than during the previous render.
	updateWorkInProgressHook (chunk-ZTUR5KCH.js:11678:87)
	updateEffectImpl (chunk-ZTUR5KCH.js:12074)
	ExcelTablePreview (ExcelTablePreview.tsx:283)
	renderWithHooks (chunk-ZTUR5KCH.js:11548)
	updateFunctionComponent (chunk-ZTUR5KCH.js:14582)
	callCallback2 (chunk-ZTUR5KCH.js:3674)
	dispatchEvent
	invokeGuardedCallbackDev (chunk-ZTUR5KCH.js:3699)
	invokeGuardedCallback (chunk-ZTUR5KCH.js:3733)
	beginWork$1 (chunk-ZTUR5KCH.js:19765)
	performUnitOfWork (chunk-ZTUR5KCH.js:19198)
	workLoopSync (chunk-ZTUR5KCH.js:19137)
	renderRootSync (chunk-ZTUR5KCH.js:19116)
	recoverFromConcurrentError (chunk-ZTUR5KCH.js:18736)
	performConcurrentWorkOnRoot (chunk-ZTUR5KCH.js:18684)
	workLoop (chunk-ZTUR5KCH.js:197)
	flushWork (chunk-ZTUR5KCH.js:176)
	performWorkUntilDeadline (chunk-ZTUR5KCH.js:384)
[Error] The above error occurred in the <ExcelTablePreview> component:

ExcelTablePreview@http://localhost:1420/src/components/Editor/ExcelTablePreview.tsx:23:38
Suspense
div
div
div
EditorPanel@http://localhost:1420/src/components/Editor/EditorPanel.tsx:78:44
div
div
div
MainLayout@http://localhost:1420/src/components/Layout/MainLayout.tsx:44:21
App@http://localhost:1420/src/App.tsx:23:34
ErrorBoundary@http://localhost:1420/src/components/Common/ErrorBoundary.tsx:7:10

React will try to recreate this component tree from scratch using the error boundary you provided, ErrorBoundary.
	logCapturedError (chunk-ZTUR5KCH.js:14032)
	callback (chunk-ZTUR5KCH.js:14078)
	callCallback (chunk-ZTUR5KCH.js:11248)
	commitUpdateQueue (chunk-ZTUR5KCH.js:11265)
	commitLayoutEffectOnFiber (chunk-ZTUR5KCH.js:17075)
	commitLayoutMountEffects_complete (chunk-ZTUR5KCH.js:17980)
	commitLayoutEffects_begin (chunk-ZTUR5KCH.js:17969)
	commitLayoutEffects (chunk-ZTUR5KCH.js:17920)
	commitRootImpl (chunk-ZTUR5KCH.js:19353)
	commitRoot (chunk-ZTUR5KCH.js:19277)
	finishConcurrentRender (chunk-ZTUR5KCH.js:18760)
	performConcurrentWorkOnRoot (chunk-ZTUR5KCH.js:18718)
	workLoop (chunk-ZTUR5KCH.js:197)
	flushWork (chunk-ZTUR5KCH.js:176)
	performWorkUntilDeadline (chunk-ZTUR5KCH.js:384)
[Error] Error caught by boundary: (2)
Error: Rendered more hooks than during the previous render. — react-dom.development.js:15688
{componentStack: "↵ExcelTablePreview@http://localhost:1420/src/compo…1420/src/components/Common/ErrorBoundary.tsx:7:10"}
	componentDidCatch (ErrorBoundary.tsx:22)
	callback (chunk-ZTUR5KCH.js:14084)
	callCallback (chunk-ZTUR5KCH.js:11248)
	commitUpdateQueue (chunk-ZTUR5KCH.js:11265)
	commitLayoutEffectOnFiber (chunk-ZTUR5KCH.js:17075)
	commitLayoutMountEffects_complete (chunk-ZTUR5KCH.js:17980)
	commitLayoutEffects_begin (chunk-ZTUR5KCH.js:17969)
	commitLayoutEffects (chunk-ZTUR5KCH.js:17920)
	commitRootImpl (chunk-ZTUR5KCH.js:19353)
	commitRoot (chunk-ZTUR5KCH.js:19277)
	finishConcurrentRender (chunk-ZTUR5KCH.js:18760)
	performConcurrentWorkOnRoot (chunk-ZTUR5KCH.js:18718)
	workLoop (chunk-ZTUR5KCH.js:197)
	flushWork (chunk-ZTUR5KCH.js:176)
	performWorkUntilDeadline (chunk-ZTUR5KCH.js:384)
[Log] 🔧 清理聊天事件监听 (ChatPanel.tsx, line 255)
[Log] 🧹 拖拽事件监听器已移除 (InlineChatInput.tsx, line 917)
- `src/components/Editor/PresentationPreview.tsx`
- `src/components/Editor/ReferenceButton.tsx`（引用按钮组件）
- `src/components/Editor/SheetNavigation.tsx`（P1，工作表标签栏）
- `src/components/Editor/SlideNavigation.tsx`（P1，幻灯片缩略图）
- `src/components/Editor/CopyToast.tsx`（P1，复制成功提示）
- `src/components/Editor/FullScreenPreview.tsx`（P1，全屏预览模式）
- `src/services/referenceService.ts`（引用服务）
- `src/types/file.ts`（扩展）
- `src/services/documentService.ts`（扩展）
- `src/components/Editor/EditorPanel.tsx`（扩展）

**后端代码：**
- `src-tauri/src/services/libreoffice_service.rs`（扩展）
- `src-tauri/src/commands/file_commands.rs`（扩展）

### 7.2 文档交付

**需求文档：**
- `预览功能需求文档.md`（已更新）

**技术文档：**
- `预览功能技术框架.md`（技术架构文档）
- `CSV预览技术方案分析.md`（CSV 独立方案分析）
- `预览功能技术优化分析.md`（技术优化分析）
- `Excel和演示文稿预览功能开发方案.md`（已生成）
- `Excel和演示文稿预览功能代码检查.md`（已生成）

**开发文档：**
- `预览功能开发计划.md`（本文档）

### 7.3 测试交付

**测试用例：**
- 功能测试用例
- 兼容性测试用例
- 性能测试用例

**测试报告：**
- 功能测试报告
- 性能测试报告
- 兼容性测试报告

---

## 八、总结

### 8.1 开发计划特点

1. **分阶段实施**：P0 → P1 → P2，逐步完善
2. **高度复用**：复用 DOCX 预览的成熟方案（Excel/演示文稿）
3. **独立优化**：CSV 使用独立方案（直接解析），性能优秀
4. **风险可控**：技术路线已验证，风险较低
5. **时间合理**：总计 3.5-5 周，符合 MVP 1.0 目标

### 8.2 关键成功因素

1. **技术方案成熟**：复用 DOCX 预览方案（Excel/演示文稿），降低风险
2. **CSV 独立优化**：使用虚拟滚动和流式解析，性能优秀
3. **开发效率高**：Excel/演示文稿 90%+ 代码可复用，开发快速
4. **质量保证**：完善的测试计划和验收标准
5. **风险控制**：识别并应对潜在风险

### 8.3 后续规划

**MVP 1.0 完成后：**
- 收集用户反馈
- 优化预览体验
- 考虑添加编辑功能（后续版本）

---

**文档版本**：v2.0  
**创建日期**：2025年  
**最后更新**：2025年  
**状态**：开发计划，待执行

**更新说明：**
- v2.0：根据技术框架和需求文档完善开发计划
  - CSV 使用独立方案（直接解析 HTML 表格 + 虚拟滚动）
  - 更新任务清单和工作量估算（总计 17.5-24 天）
  - 更新技术实现细节（虚拟滚动、流式解析）
  - 更新测试计划（CSV 大文件测试）
  - 明确 Excel 预览分为两部分：XLSX/XLS/ODS（PDF 转换）和 CSV（独立方案）

